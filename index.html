<!DOCTYPE html>
<html lang="hr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Inkunabule — ustanove (mjesta čuvanja)</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />
<style>
  :root { --panel-w: 340px; --radius: 10px; --font: 14px; }
  html, body, #map { height:100%; margin:0; }

  #togglePanel {
    position:absolute; bottom:14px; left:14px; z-index:1100;
    background:#fff; border:1px solid #aaa; border-radius:var(--radius); padding:6px 10px;
    cursor:pointer; font-size:20px; box-shadow:0 3px 10px rgba(0,0,0,0.18);
  }
  .panel {
    position:absolute; top:0; left:0; height:100%; width:var(--panel-w);
    z-index:1000; background:rgba(255,255,255,0.98); border-right:1px solid #ddd;
    transform: translateX(calc(-1 * var(--panel-w)));
    transition: transform 0.25s ease; box-shadow: 2px 0 12px rgba(0,0,0,0.12);
    font-family: system-ui,-apple-system,Segoe UI,Roboto,sans-serif; font-size: var(--font);
    display:flex; flex-direction:column;
  }
  .panel.open { transform: translateX(0); }
  .panel header { display:flex; align-items:center; justify-content:space-between; padding:8px; border-bottom:1px solid #eee; }
  .panel header h3 { margin:0; font-size:15px; }
  .panel .content { padding:8px; overflow:auto; }
  details.filter { margin-bottom:6px; border:1px solid #e6e6e6; border-radius:8px; background:#fafafa; }
  details.filter > summary { cursor:pointer; list-style:none; padding:6px 8px; font-weight:600; }
  details.filter .inner { padding:6px 8px 8px; }
  .btn-row { display:flex; gap:8px; padding:6px 8px; border-top:1px solid #eee; }
  .btn { padding:6px 10px; border-radius:8px; border:1px solid #bbb; background:#fff; cursor:pointer; font-size:13px; }
  .btn.primary { background:#0b5ed7; color:#fff; border-color:#0b5ed7; }

  .leaflet-popup-content-wrapper { border-radius:12px; max-width: 760px !important; box-shadow:0 4px 12px rgba(0,0,0,0.25);}
  .leaflet-popup-content { margin:10px; width: 720px !important; font-size:13px; }

  .acc-item { border-bottom:1px solid #eee; }
  .acc-head { cursor:pointer; padding:6px 0; font-weight:600; display:flex; align-items:center; gap:6px; font-size:13px;}
  .acc-body { display:none; padding:6px 0 8px 6px; overflow:auto; }
  .table-mini { width:100%; min-width:680px; border-collapse:collapse; font-size:12px; }
  .table-mini th, .table-mini td { padding:4px 8px; border-bottom:1px solid #eee; white-space:nowrap; text-overflow:ellipsis; overflow:hidden; }
  .table-mini th.num, .table-mini td.num { width:70px; text-align:right; }
</style>
</head>
<body>
<div id="map"></div>
<button id="togglePanel">≡</button>

<div class="panel" id="panel">
  <header><h3>Filtri</h3><button class="btn" id="closePanel">✕</button></header>
  <div class="content">
    <details class="filter"><summary>Mjesto (čuvanja)</summary>
      <div class="inner"><select id="placeSel" multiple size="7"><option value="">(sva mjesta)</option></select></div>
    </details>
    <details class="filter"><summary>Ustanova</summary>
      <div class="inner"><select id="instSel" multiple size="7"><option value="">(sve ustanove)</option></select></div>
    </details>
    <details class="filter"><summary>Tiskar</summary>
      <div class="inner"><select id="prnSel" multiple size="7"><option value="">(svi tiskari)</option></select></div>
    </details>
    <details class="filter"><summary>Godine</summary>
      <div class="inner" style="display:grid; grid-template-columns:1fr 1fr; gap:6px;">
        <div><label>od</label><input type="number" id="yMin" value="1470"></div>
        <div><label>do</label><input type="number" id="yMax" value="1501"></div>
      </div>
    </details>
  </div>
  <div class="btn-row"><button class="btn primary" id="applyBtn">Primijeni</button><button class="btn" id="resetBtn">Poništi</button></div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
<script>
const RAW = [{"place": "Bol", "lat": 43.2605186, "lon": 16.6520192, "total": 1, "institutions": [{"name": "Dominikanski samostan Sv. Marije Milosne", "label": "Dominikanski samostan Sv. Marije Milosne, Bol", "count": 1, "exemplars": [{"author": "", "title": "Misal po zakonu rimskoga dvora", "year": 1483, "printer": "", "print_place": ""}]}]}, {"place": "Cavtat", "lat": 42.5814314, "lon": 18.2177461, "total": 33, "institutions": [{"name": "Zbirka Baltazara Bogišića", "label": "Zbirka Baltazara Bogišića, Cavtat", "count": 33, "exemplars": [{"author": "VARRO, MARCUS TERENTIUS", "title": "De lingua Latina lib. III.", "year": 1483, "printer": "Dobrićević, Dobrić Delsera, Miniatus", "print_place": "Brescia"}, {"author": "", "title": "Elegiae", "year": 1487, "printer": "Paltašić, Andrija", "print_place": "Venecija"}, {"author": "TIBULLUS, ALBIUS", "title": "Elegiae sive carmina", "year": 1486, "printer": "Dobrićević, Dobrić", "print_place": "Brescia"}, {"author": "", "title": "Statuta Cremonae", "year": 1485, "printer": "Dobrićević, Dobrić", "print_place": "Brescia"}, {"author": "PUCIĆ, KARLO", "title": "Elegiarum libellus De laudibus Gnesae puellae", "year": 1495, "printer": "Damianus de Gorgonzola", "print_place": "Venecija"}, {"author": "PROPERTIUS, SEXTUS AURELIUS", "title": "Elegiae", "year": 1488, "printer": "Paltašić, Andrija", "print_place": "Venecija"}, {"author": "PROPERTIUS, SEXTUS AURELIUS", "title": "Elegiae", "year": 1486, "printer": "Dobrićević, Dobrić", "print_place": "Brescia"}, {"author": "PLUTARCHUS", "title": "Parallela minora", "year": 1485, "printer": "Dobrićević, Dobrić", "print_place": "Brescia"}, {"author": "PLUTARCHUS", "title": "De claris mulieribus. De virtutibus mulierum.", "year": 1485, "printer": "Dobrićević, Dobrić", "print_place": "Brescia"}, {"author": "NONIUS MARCELLUS", "title": "De proprietate Latini sermonis.", "year": 1483, "printer": "Dobrićević, Dobrić", "print_place": "Brescia"}, {"author": "NIKOLA MODRUŠKI", "title": "Oratio in funere Petri cardinalis s. Sixti habita.", "year": 1481, "printer": "Plannck, Stephan", "print_place": "Rim"}, {"author": "NIKOLA MODRUŠKI", "title": "Oratio in funere Petri cardinalis s. Sixti habita.", "year": 1474, "printer": "Gensberg, Johannes", "print_place": "Rim"}, {"author": "MARCHESINUS, JOHANNES", "title": "Mammotrectus super Bibliam.", "year": 1482, "printer": "Paltašić, Andrija Scotus, Octavianus", "print_place": "Venecija"}, {"author": "MACROBIUS, AURELIUS THEODOSIUS", "title": "In somnium Scipionis expositio. Saturnalia.", "year": 1485, "printer": "Dobrićević, Dobrić", "print_place": "Brescia"}, {"author": "LUDOVICUS A TURRI DE VERONA", "title": "De immaculata conceptione B.V. Mariae", "year": 1486, "printer": "Dobrićević, Dobrić", "print_place": "Brescia"}, {"author": "LACTANTIUS, LUCIUS CAECILIUS FIRMIANUS", "title": "Opera", "year": 1478, "printer": "Paltašić, Andrija Dobrićević, Dobrić", "print_place": "Venecija"}, {"author": "JACOBUS PHILIPPUS DE BERGAMO", "title": "Supplementum chronicarum", "year": 1485, "printer": "Dobrićević, Dobrić", "print_place": "Brescia"}, {"author": "GELLIUS, AULUS", "title": "Noctes Atticae", "year": 1485, "printer": "Dobrićević, Dobrić", "print_place": "Brescia"}, {"author": "GELLIUS, AULUS", "title": "Noctes Atticae", "year": 1477, "printer": "Paltašić, Andrija", "print_place": "Venecija"}, {"author": "FESTUS, SEXTUS POMPEIUS", "title": "De verborum significatione", "year": 1483, "printer": "Dobrićević, Dobrić", "print_place": "Brescia"}, {"author": "DRAGIŠIĆ, JURAJ", "title": "Oratio funebris pro Junio Georgio habita", "year": 1499, "printer": "Nepoznat", "print_place": "Firenza"}, {"author": "DIODORUS, SICULUS Tacitus, Gaius Cornelius", "title": "Bibliothecae historicae libri VI.", "year": 1476, "printer": "Paltašić, Andrija", "print_place": "Venecija"}, {"author": "CICERO, MARCUS TULLIUS", "title": "Epistolae ad familiares", "year": 1487, "printer": "Paltašić, Andrija", "print_place": "Venecija"}, {"author": "CATULLUS, GAIUS VALERIUS", "title": "Carmina", "year": 1486, "printer": "Dobrićević, Dobrić", "print_place": "Brescia"}, {"author": "BURLAEUS, GUALTHERUS", "title": "Expositio in artem veterem Porphyrii et Aristotelis", "year": 1492, "printer": "Paltašić, Andrija", "print_place": "Venecija"}, {"author": "BLONDUS, FLAVIUS", "title": "Roma instaurata.", "year": 1481, "printer": "Dobrićević, Dobrić", "print_place": "Verona"}, {"author": "BALDUS DE UBALDIS", "title": "Consiliorum partes V.", "year": 1490, "printer": "Dobrićević, Dobrić", "print_place": "Brescia"}, {"author": "AURELIUS, VICTOR SEXTUS", "title": "De viris illustribus", "year": 1477, "printer": "Paltašić, Andrija", "print_place": "Venecija"}, {"author": "AURELIUS, VICTOR SEXTUS", "title": "De viris illustribus", "year": 1477, "printer": "Paltašić, Andrija", "print_place": "Venecija"}, {"author": "ANTONINUS FLORENTINUS", "title": "Summa theologica. Pars III.", "year": 1485, "printer": "Paltašić, Andrija", "print_place": "Venecija"}, {"author": "ALBERTUS MAGNUS, SANCTUS", "title": "Compendium theologicae veritatis", "year": 1483, "printer": "Grgur Senjanin Jacobum Britannicum", "print_place": "Venecija"}, {"author": "ALBERTUS DE SAXONIA", "title": "De proportionibus.", "year": 1487, "printer": "Paltašić, Andrija", "print_place": "Venecija"}, {"author": "AEGIDII, GUILLERMUS", "title": "Super coelestium motuum indigatione", "year": 1494, "printer": "Darleri, Carlo", "print_place": "Cremona"}]}]}, {"place": "Cres", "lat": 44.960346, "lon": 14.4079371, "total": 1, "institutions": [{"name": "Franjevački samostan sv. Franje", "label": "Franjevački samostan sv. Franje, Cres", "count": 1, "exemplars": [{"author": "", "title": "Senjski glagoljski misal", "year": 1494, "printer": "Bedričić, Silvestar Turčić, Gašpar Baromić, Blaž", "print_place": "Senj"}]}]}, {"place": "Dubrovnik", "lat": 42.6507, "lon": 18.0944, "total": 18, "institutions": [{"name": "Državni arhiv Dubrovnik", "label": "Državni arhiv Dubrovnik, Dubrovnik", "count": 1, "exemplars": [{"author": "BALDUS DE UBALDIS", "title": "Consiliorum partes V.", "year": 1490, "printer": "Dobrićević, Dobrić", "print_place": "Brescia"}]}, {"name": "Franjevački samostan Male braće", "label": "Franjevački samostan Male braće, Dubrovnik", "count": 10, "exemplars": [{"author": "SUETONIUS TRANQUILLUS, GAIUS", "title": "Vitae XII caesarum", "year": 1488, "printer": "Benedictis, Franciscus (Plato) de", "print_place": "Bologna"}, {"author": "ODONIS, GERALDUS", "title": "Expositio in Aristotelis Ethica", "year": 1482, "printer": "Dobrićević, Dobrić Manerva, Bonifacius de", "print_place": "Brescia"}, {"author": "HIERONYMUS, SANCTUS", "title": "Vita et transitus", "year": 1475, "printer": "Pietro, Gabriele di", "print_place": "Venecija"}, {"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1496, "printer": "Vercellensis, Johannes Rubeus", "print_place": "Venecija"}, {"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1480, "printer": "Typ. Hieronymi", "print_place": "Parma"}, {"author": "DRAGIŠIĆ, JURAJ", "title": "Oratio funebris pro Junio Georgio habita", "year": 1499, "printer": "Nepoznat", "print_place": "Firenza"}, {"author": "DRAGIŠIĆ, JURAJ", "title": "De natura angelica.", "year": 1499, "printer": "Libris, Bartholomeo de", "print_place": "Firenza"}, {"author": "CIPIKO, KORIOLAN", "title": "Petri Mocenici imperatoris gesta", "year": 1477, "printer": "Ratdolt, Erhard Löslein, Peter", "print_place": "Venecija"}, {"author": "Aristotelis", "title": "Auctoritates", "year": 1495, "printer": "Paganini, Paganino de’, st.", "print_place": "Venecija"}, {"author": "ALBERTUS MAGNUS, SANCTUS", "title": "Compendium theologicae veritatis", "year": 1483, "printer": "Grgur Senjanin Jacobum Britannicum", "print_place": "Venecija"}]}, {"name": "Znanstvena knjižnica", "label": "Znanstvena knjižnica, Dubrovnik", "count": 7, "exemplars": [{"author": "JACOBUS PHILIPPUS DE BERGAMO", "title": "Supplementum chronicarum", "year": 1485, "printer": "Dobrićević, Dobrić", "print_place": "Brescia"}, {"author": "IUVENALIS, DECIMUS IUNIUS", "title": "Satyrae", "year": 1488, "printer": "Paltašić, Andrija", "print_place": "Venecija"}, {"author": "GELLIUS, AULUS", "title": "Noctes Atticae", "year": 1485, "printer": "Dobrićević, Dobrić", "print_place": "Brescia"}, {"author": "DRAGIŠIĆ, JURAJ", "title": "De natura angelica.", "year": 1499, "printer": "Libris, Bartholomeo de", "print_place": "Firenza"}, {"author": "CICERO, MARCUS TULLIUS", "title": "Epistole ad familiares", "year": 1480, "printer": "Paltašić, Andrija", "print_place": "Venecija"}, {"author": "CICERO, MARCUS TULLIUS", "title": "De oratore", "year": 1478, "printer": "Paltašić, Andrija", "print_place": "Venecija"}, {"author": "BLONDUS, FLAVIUS", "title": "Roma instaurata.", "year": 1481, "printer": "Dobrićević, Dobrić", "print_place": "Verona"}]}]}, {"place": "Hvar", "lat": 43.1739411, "lon": 16.5565161, "total": 5, "institutions": [{"name": "Franjevački samostan Gospe od milosti", "label": "Franjevački samostan Gospe od milosti, Hvar", "count": 3, "exemplars": [{"author": "LUDOVICUS A TURRI DE VERONA", "title": "De immaculata conceptione B.V. Mariae", "year": 1486, "printer": "Dobrićević, Dobrić", "print_place": "Brescia"}, {"author": "HIERONYMUS, SANCTUS", "title": "Vitae sanctorum patrum, sive Vitas patrum", "year": 1476, "printer": "Miscomini, Antonio di Bartolommeo", "print_place": "Venecija"}, {"author": "CICERO, MARCUS TULLIUS", "title": "Epistole ad familiares", "year": 1480, "printer": "Paltašić, Andrija", "print_place": "Venecija"}]}, {"name": "Knjižnica Hvarske biskupije", "label": "Knjižnica Hvarske biskupije, Hvar", "count": 2, "exemplars": [{"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1496, "printer": "Vercellensis, Johannes Rubeus", "print_place": "Venecija"}, {"author": "HIERONYMUS, SANCTUS", "title": "Commentaria in Bibliam", "year": 1497, "printer": "Gregoriis, Johannes de", "print_place": "Venecija"}]}]}, {"place": "Kampor", "lat": 44.7768332, "lon": 14.7279432, "total": 2, "institutions": [{"name": "Franjevački samostan sv. Bernardina Sijenskog", "label": "Franjevački samostan sv. Bernardina Sijenskog, Kampor", "count": 2, "exemplars": [{"author": "MARCHESINUS, JOHANNES", "title": "Mammotrectus super Bibliam.", "year": 1482, "printer": "Paltašić, Andrija Scotus, Octavianus", "print_place": "Venecija"}, {"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1476, "printer": "Miscomini, Antonio di Bartolommeo", "print_place": "Venecija"}]}]}, {"place": "Koprivnica", "lat": 46.1623335, "lon": 16.8307909, "total": 1, "institutions": [{"name": "Franjevački samostan sv. Antuna Padovanskog", "label": "Franjevački samostan sv. Antuna Padovanskog, Koprivnica", "count": 1, "exemplars": [{"author": "HIERONYMUS, SANCTUS", "title": "Commentaria in Bibliam", "year": 1497, "printer": "Gregoriis, Johannes de", "print_place": "Venecija"}]}]}, {"place": "Korčula", "lat": 42.9437813, "lon": 16.9134763, "total": 2, "institutions": [{"name": "Opatska knjižnica", "label": "Opatska knjižnica, Korčula", "count": 2, "exemplars": [{"author": "MACROBIUS, AURELIUS THEODOSIUS", "title": "In somnium Scipionis expositio. Saturnalia.", "year": 1485, "printer": "Dobrićević, Dobrić", "print_place": "Brescia"}, {"author": "GELLIUS, AULUS", "title": "Noctes Atticae", "year": 1485, "printer": "Dobrićević, Dobrić", "print_place": "Brescia"}]}]}, {"place": "Košljun", "lat": 45.0335, "lon": 14.626, "total": 6, "institutions": [{"name": "Franjevački samostan Navještenja Marijina", "label": "Franjevački samostan Navještenja Marijina, Košljun", "count": 6, "exemplars": [{"author": "ŠIMUN HVARANIN", "title": "De baptismo Sancti Spiritus et eius virtute", "year": 1477, "printer": "Gallo, Guglielmo", "print_place": "Venecija"}, {"author": "HIERONYMUS, SANCTUS", "title": "Vitae sanctorum patrum, sive Vitas patrum", "year": 1483, "printer": "Scotus, Octavianus", "print_place": "Venecija"}, {"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1489, "printer": "Kessler, Nicolaus", "print_place": "Basel"}, {"author": "Aristotelis", "title": "Auctoritates", "year": 1495, "printer": "Paganini, Paganino de’, st.", "print_place": "Venecija"}, {"author": "ANTONINUS FLORENTINUS", "title": "Summa theologica. Pars III.", "year": 1485, "printer": "Paltašić, Andrija", "print_place": "Venecija"}, {"author": "", "title": "Misal po zakonu rimskoga dvora", "year": 1483, "printer": "", "print_place": ""}]}]}, {"place": "Kraj", "lat": 43.9519, "lon": 15.4078, "total": 1, "institutions": [{"name": "Franjevački samostan sv. Duje", "label": "Franjevački samostan sv. Duje, Kraj", "count": 1, "exemplars": [{"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1496, "printer": "Vercellensis, Johannes Rubeus", "print_place": "Venecija"}]}]}, {"place": "Našice", "lat": 45.4907759, "lon": 18.0938075, "total": 1, "institutions": [{"name": "Franjevački samostan sv. Antuna Padovanskog", "label": "Franjevački samostan sv. Antuna Padovanskog, Našice", "count": 1, "exemplars": [{"author": "HIERONYMUS, SANCTUS", "title": "Commentaria in Bibliam", "year": 1497, "printer": "Gregoriis, Johannes de", "print_place": "Venecija"}]}]}, {"place": "Pula", "lat": 44.8683, "lon": 13.8481, "total": 2, "institutions": [{"name": "Sveučilišna knjižnica u Puli", "label": "Sveučilišna knjižnica u Puli, Pula", "count": 2, "exemplars": [{"author": "VERGERIUS, PETRUS PAULUS", "title": "De ingenuis moribus ac liberalibus studiis", "year": 1475, "printer": "Siliprandi, Domenico", "print_place": "Padova"}, {"author": "PHALARIS", "title": "Epistolae", "year": 1498, "printer": "Pelusius, Bartholomaeus Bracius, Gabriel Bissolus, Johannes Mangius, Benedictus", "print_place": "Venecija"}]}]}, {"place": "Rijeka", "lat": 45.3271, "lon": 14.4422, "total": 1, "institutions": [{"name": "Franjevački samostan Majke Božje Trsatske", "label": "Franjevački samostan Majke Božje Trsatske, Rijeka", "count": 1, "exemplars": [{"author": "", "title": "EVANGELISTARIUM ILLYRICUM", "year": 1495, "printer": "Damianus de Gorgonzola", "print_place": "Venecija"}]}]}, {"place": "Split", "lat": 43.5081, "lon": 16.4402, "total": 9, "institutions": [{"name": "Arheološki muzej", "label": "Arheološki muzej, Split", "count": 3, "exemplars": [{"author": "HIERONYMUS, SANCTUS", "title": "Vita et transitus", "year": 1490, "printer": "Bonaccorsi, Francesco", "print_place": "Firenza"}, {"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1497, "printer": "Kessler, Nicolaus", "print_place": "Basel"}, {"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1489, "printer": "Kessler, Nicolaus", "print_place": "Basel"}]}, {"name": "Bogoslovno sjemenište", "label": "Bogoslovno sjemenište, Split", "count": 1, "exemplars": [{"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1476, "printer": "Miscomini, Antonio di Bartolommeo", "print_place": "Venecija"}]}, {"name": "Dominikanski samostan sv. Katarine", "label": "Dominikanski samostan sv. Katarine, Split", "count": 2, "exemplars": [{"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1480, "printer": "Typ. Hieronymi", "print_place": "Parma"}, {"author": "HIERONYMUS, SANCTUS", "title": "Commentaria in Bibliam", "year": 1497, "printer": "Gregoriis, Johannes de", "print_place": "Venecija"}]}, {"name": "Franjevački samostan svetog Ante", "label": "Franjevački samostan svetog Ante, Split", "count": 1, "exemplars": [{"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1480, "printer": "Typ. Hieronymi", "print_place": "Parma"}]}, {"name": "Katolički bogoslovni fakultet", "label": "Katolički bogoslovni fakultet, Split", "count": 1, "exemplars": [{"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1497, "printer": "Kessler, Nicolaus", "print_place": "Basel"}]}, {"name": "Prva gimnazija Split", "label": "Prva gimnazija Split, Split", "count": 1, "exemplars": [{"author": "ARISTOTELES", "title": "Politica", "year": 1492, "printer": "Silber, Eucharius", "print_place": "Rim"}]}]}, {"place": "Trogir", "lat": 43.5167, "lon": 16.25, "total": 1, "institutions": [{"name": "Muzej grada Trogira", "label": "Muzej grada Trogira, Trogir", "count": 1, "exemplars": [{"author": "CIPIKO, KORIOLAN", "title": "Petri Mocenici imperatoris gesta", "year": 1477, "printer": "Ratdolt, Erhard Löslein, Peter", "print_place": "Venecija"}]}]}, {"place": "Varaždin", "lat": 46.3057, "lon": 16.3366, "total": 1, "institutions": [{"name": "Franjevački samostan sv. Ivana Krstitelja", "label": "Franjevački samostan sv. Ivana Krstitelja, Varaždin", "count": 1, "exemplars": [{"author": "HIERONYMUS, SANCTUS", "title": "Vitae sanctorum patrum, sive Vitas patrum", "year": 1483, "printer": "Scotus, Octavianus", "print_place": "Venecija"}]}]}, {"place": "Visovac", "lat": 43.8611444, "lon": 15.9732853, "total": 1, "institutions": [{"name": "Franjevački samostan Gospe od anđela", "label": "Franjevački samostan Gospe od anđela, Visovac", "count": 1, "exemplars": [{"author": "AESOPUS", "title": "Aesopus moralisatus", "year": 1487, "printer": "Dobrićević, Dobrić", "print_place": "Brescia"}]}]}, {"place": "Zadar", "lat": 44.1194, "lon": 15.2314, "total": 12, "institutions": [{"name": "Državni arhiv u Zadru", "label": "Državni arhiv u Zadru, Zadar", "count": 1, "exemplars": [{"author": "CIPIKO, KORIOLAN", "title": "Petri Mocenici imperatoris gesta", "year": 1477, "printer": "Ratdolt, Erhard Löslein, Peter", "print_place": "Venecija"}]}, {"name": "Franjevački samostan sv. Frane", "label": "Franjevački samostan sv. Frane, Zadar", "count": 7, "exemplars": [{"author": "HIERONYMUS, SANCTUS", "title": "Vitae sanctorum patrum, sive Vitas patrum", "year": 1479, "printer": "Girardengus, Nicolaus, de Novis", "print_place": "Venecija"}, {"author": "HIERONYMUS, SANCTUS", "title": "Epistole", "year": 1490, "printer": "Benalius, Bernardinus", "print_place": "Venecija"}, {"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1480, "printer": "Typ. Hieronymi", "print_place": "Parma"}, {"author": "BARTOLUS DE SAXOFERRATO", "title": "Super secunda parte Digesti veteris cum additionibus Alexandri Tartagni.", "year": 1492, "printer": "Paltašić, Andrija", "print_place": "Venecija"}, {"author": "BARTOLUS DE SAXOFERRATO", "title": "Super prima parte Codicis cum additionibus Alexandri Tartagni.", "year": 1491, "printer": "Paltašić, Andrija", "print_place": "Venecija"}, {"author": "BARTOLUS DE SAXOFERRATO", "title": "Super secunda parte Codicis cum additionibus Alexandri Tartagni.", "year": 1490, "printer": "Paltašić, Andrija", "print_place": "Venecija"}, {"author": "BARTOLUS DE SAXOFERRATO", "title": "Super prima parte Digesti veteris cum additionibus Alexandri Tartagni.", "year": 1490, "printer": "Paltašić, Andrija", "print_place": "Venecija"}]}, {"name": "Nadbiskupski ordinarijat", "label": "Nadbiskupski ordinarijat, Zadar", "count": 1, "exemplars": [{"author": "HIERONYMUS, SANCTUS", "title": "Vita et transitus", "year": 1487, "printer": "Hannibal Foxius", "print_place": "Venecija"}]}, {"name": "Znanstvena knjižnica Sveučilišta u Zadru", "label": "Znanstvena knjižnica Sveučilišta u Zadru, Zadar", "count": 3, "exemplars": [{"author": "LACTANTIUS, LUCIUS CAECILIUS FIRMIANUS", "title": "Opera", "year": 1478, "printer": "Paltašić, Andrija Dobrićević, Dobrić", "print_place": "Venecija"}, {"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1496, "printer": "Vercellensis, Johannes Rubeus", "print_place": "Venecija"}, {"author": "BLONDUS, FLAVIUS", "title": "Roma instaurata.", "year": 1481, "printer": "Dobrićević, Dobrić", "print_place": "Verona"}]}]}, {"place": "Zagreb", "lat": 45.815, "lon": 15.9819, "total": 75, "institutions": [{"name": "Franjevački samostan sv. Franje Asiškog", "label": "Franjevački samostan sv. Franje Asiškog, Zagreb", "count": 1, "exemplars": [{"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1470, "printer": "Sweynheym, Konrad Pannartz, Arnold", "print_place": "Rim"}]}, {"name": "Knjižnica 'Juraj Habdelić'", "label": "Knjižnica 'Juraj Habdelić', Zagreb", "count": 4, "exemplars": [{"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1476, "printer": "Miscomini, Antonio di Bartolommeo", "print_place": "Venecija"}, {"author": "HIERONYMUS, SANCTUS", "title": "Commentaria in Bibliam", "year": 1497, "printer": "Gregoriis, Johannes de", "print_place": "Venecija"}, {"author": "", "title": "EVANGELISTARIUM ILLYRICUM", "year": 1495, "printer": "Damianus de Gorgonzola", "print_place": "Venecija"}, {"author": "DRAGIŠIĆ, JURAJ", "title": "De natura angelica.", "year": 1499, "printer": "Libris, Bartholomeo de", "print_place": "Firenza"}]}, {"name": "Knjižnica Hrvatske akademije znanosti i umjetnosti", "label": "Knjižnica Hrvatske akademije znanosti i umjetnosti, Zagreb", "count": 6, "exemplars": [{"author": "TERENTIUS AFER, PUBLIUS", "title": "Comoediae", "year": 1487, "printer": "Paltašić, Andrija", "print_place": "Venecija"}, {"author": "ŠIŽGORIĆ, JURAJ", "title": "Elegiarum et carminum libri tres.", "year": 1477, "printer": "Adamus, Rotwilensis", "print_place": "Venecija"}, {"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1497, "printer": "Kessler, Nicolaus", "print_place": "Basel"}, {"author": "DRAGIŠIĆ, JURAJ", "title": "De natura angelica.", "year": 1499, "printer": "Libris, Bartholomeo de", "print_place": "Firenza"}, {"author": "", "title": "Misal po zakonu rimskoga dvora", "year": 1483, "printer": "", "print_place": ""}, {"author": "", "title": "Misal po zakonu rimskoga dvora", "year": 1483, "printer": "", "print_place": ""}]}, {"name": "Knjižnice Grada Zagreba", "label": "Knjižnice Grada Zagreba, Zagreb", "count": 1, "exemplars": [{"author": "", "title": "Misal po zakonu rimskoga dvora", "year": 1483, "printer": "", "print_place": ""}]}, {"name": "Metropolitanska knjižnica", "label": "Metropolitanska knjižnica, Zagreb", "count": 10, "exemplars": [{"author": "VALTURIUS, ROBERTUS", "title": "De re militari", "year": 1483, "printer": "Dobrićević, Dobrić", "print_place": "Verona"}, {"author": "MACROBIUS, AURELIUS THEODOSIUS", "title": "In somnium Scipionis expositio. Saturnalia.", "year": 1485, "printer": "Dobrićević, Dobrić", "print_place": "Brescia"}, {"author": "MACROBIUS, AURELIUS THEODOSIUS", "title": "In somnium Scipionis expositio. Saturnalia.", "year": 1485, "printer": "Dobrićević, Dobrić", "print_place": "Brescia"}, {"author": "HIERONYMUS, SANCTUS", "title": "Vitae sanctorum patrum, sive Vitas patrum", "year": 1483, "printer": "Scotus, Octavianus", "print_place": "Venecija"}, {"author": "HIERONYMUS, SANCTUS", "title": "Vita et transitus", "year": 1485, "printer": "Pasqualibus, Peregrinus de Bertochus, Dominicus", "print_place": "Venecija"}, {"author": "HIERONYMUS, SANCTUS", "title": "Vita et transitus", "year": 1485, "printer": "Pasqualibus, Peregrinus de Bertochus, Dominicus", "print_place": "Venecija"}, {"author": "GELLIUS, AULUS", "title": "Noctes Atticae", "year": 1485, "printer": "Dobrićević, Dobrić", "print_place": "Brescia"}, {"author": "GELLIUS, AULUS", "title": "Noctes Atticae", "year": 1477, "printer": "Paltašić, Andrija", "print_place": "Venecija"}, {"author": "BARTOLUS DE SAXOFERRATO", "title": "Super secunda parte Digesti veteris cum additionibus Alexandri Tartagni.", "year": 1492, "printer": "Paltašić, Andrija", "print_place": "Venecija"}, {"author": "BARTOLUS DE SAXOFERRATO", "title": "Super prima parte Codicis cum additionibus Alexandri Tartagni.", "year": 1491, "printer": "Paltašić, Andrija", "print_place": "Venecija"}]}, {"name": "Muzej suvremene umjetnosti", "label": "Muzej suvremene umjetnosti, Zagreb", "count": 1, "exemplars": [{"author": "HIERONYMUS, SANCTUS", "title": "Commentaria in Bibliam", "year": 1497, "printer": "Gregoriis, Johannes de", "print_place": "Venecija"}]}, {"name": "Nacionalna i sveučilišna knjižnica u Zagrebu", "label": "Nacionalna i sveučilišna knjižnica u Zagrebu, Zagreb", "count": 49, "exemplars": [{"author": "VERGILIUS MARO, PUBLIUS", "title": "Opera", "year": 1488, "printer": "Paltašić, Andrija", "print_place": "Venecija"}, {"author": "VERGERIUS, PETRUS PAULUS", "title": "De ingenuis moribus ac liberalibus studiis", "year": 1497, "printer": "Tacuinus, Giovanni", "print_place": "Venecija"}, {"author": "VARRO, MARCUS TERENTIUS", "title": "De lingua Latina lib. III.", "year": 1483, "printer": "Dobrićević, Dobrić Delsera, Miniatus", "print_place": "Brescia"}, {"author": "VALTURIUS, ROBERTUS", "title": "De re militari", "year": 1483, "printer": "Dobrićević, Dobrić", "print_place": "Verona"}, {"author": "TORTELLIUS, JOHANNES", "title": "De orthographia dictionum e Graecis tractarum.", "year": 1488, "printer": "Paltašić, Andrija", "print_place": "Venecija"}, {"author": "TIBULLUS, ALBIUS", "title": "Elegiae", "year": 1487, "printer": "Paltašić, Andrija", "print_place": "Venecija"}, {"author": "ŠIMUN HVARANIN", "title": "De baptismo Sancti Spiritus et eius virtute", "year": 1477, "printer": "Gallo, Guglielmo", "print_place": "Venecija"}, {"author": "PUCIĆ, KARLO", "title": "Elegiarum libellus De laudibus Gnesae puellae", "year": 1495, "printer": "Damianus de Gorgonzola", "print_place": "Venecija"}, {"author": "PROPERTIUS, SEXTUS AURELIUS", "title": "Elegiae", "year": 1488, "printer": "Paltašić, Andrija", "print_place": "Venecija"}, {"author": "PROBUS, MARCUS VALERIUS", "title": "De interpretandis Romanorum litteris.", "year": 1486, "printer": "Dobrićević, Dobrić", "print_place": "Brescia"}, {"author": "", "title": "OFFICIUM", "year": 1501, "printer": "Dobrićević, Dobrić", "print_place": "Lyon"}, {"author": "NIMIRA, MARTINUS DE", "title": "Sermo de passione Domini.", "year": 1494, "printer": "Silber, Eucharius", "print_place": "Rim"}, {"author": "NIKOLA MODRUŠKI", "title": "Oratio in funere Reverendissimi domini D. Petri Cardinalis sancti Sixti habita a revere[n]do patre d[omi]no Nicolao ep[isco]po Modrusien[si]", "year": 1484, "printer": "Guldinbeck, Bartholomaeus", "print_place": "Rim"}, {"author": "NIGER, FRANJO", "title": "Modus epistolandi.", "year": 1495, "printer": "Bevilacqua, Simone", "print_place": "Venecija"}, {"author": "NIGER, FRANJO", "title": "Modus epistolandi.", "year": 1492, "printer": "Capcasa, Matteo", "print_place": "Venecija"}, {"author": "LACTANTIUS, LUCIUS CAECILIUS FIRMIANUS", "title": "Opera", "year": 1478, "printer": "Paltašić, Andrija Dobrićević, Dobrić", "print_place": "Venecija"}, {"author": "JACOBUS PHILIPPUS DE BERGAMO", "title": "Supplementum chronicarum", "year": 1485, "printer": "Dobrićević, Dobrić", "print_place": "Brescia"}, {"author": "JACOBUS DE VORAGINE", "title": "Legenda aurea sanctorum, sive Lombardica historia", "year": 1482, "printer": "Paltašić, Andrija Scotus, Octavianus", "print_place": "Venecija"}, {"author": "HIERONYMUS, SANCTUS", "title": "Vitae sanctorum patrum, sive Vitas patrum", "year": 1483, "printer": "Scotus, Octavianus", "print_place": "Venecija"}, {"author": "HIERONYMUS, SANCTUS", "title": "Vitae sanctorum patrum, sive Vitas patrum", "year": 1479, "printer": "Lichtenstein, Hermann", "print_place": "Vicenza"}, {"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1496, "printer": "Vercellensis, Johannes Rubeus", "print_place": "Venecija"}, {"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1496, "printer": "Vercellensis, Johannes Rubeus", "print_place": "Venecija"}, {"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1489, "printer": "Kessler, Nicolaus", "print_place": "Basel"}, {"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1476, "printer": "Miscomini, Antonio di Bartolommeo", "print_place": "Venecija"}, {"author": "GELLIUS, AULUS", "title": "Noctes Atticae", "year": 1485, "printer": "Dobrićević, Dobrić", "print_place": "Brescia"}, {"author": "GELLIUS, AULUS", "title": "Noctes Atticae", "year": 1477, "printer": "Paltašić, Andrija", "print_place": "Venecija"}, {"author": "FIDELIS, CASSANDRA", "title": "Oratio pro Bertucio Lamberto etc.", "year": 1489, "printer": "Wagner, Petrus", "print_place": "Nürnberg"}, {"author": "FICINUS, MARSILIUS", "title": "De triplici vita", "year": 1498, "printer": "Pelusius, Bartholomaeus Bracius, Gabriel Bissolus, Johannes Mangius, Benedictus", "print_place": "Venecija"}, {"author": "DRAGIŠIĆ, JURAJ", "title": "De natura angelica.", "year": 1499, "printer": "Libris, Bartholomeo de", "print_place": "Firenza"}, {"author": "DIONYSIUS CARTHUSIANUS", "title": "Dialogus Mariae et peccatoris etc.", "year": 1480, "printer": "Braem, Konrad", "print_place": "Löwen"}, {"author": "DIODORUS, SICULUS Tacitus, Gaius Cornelius", "title": "Bibliothecae historicae libri VI.", "year": 1476, "printer": "Paltašić, Andrija", "print_place": "Venecija"}, {"author": "CIPIKO, KORIOLAN", "title": "Petri Mocenici imperatoris gesta", "year": 1477, "printer": "Ratdolt, Erhard Löslein, Peter", "print_place": "Venecija"}, {"author": "CICERO, MARCUS TULLIUS", "title": "Epistolae ad familiares (comm. Hubertinus Clericus Crescentinas)", "year": 1488, "printer": "Paltašić, Andrija", "print_place": "Venecija"}, {"author": "BURLAEUS, GUALTHERUS", "title": "Expositio in artem veterem Porphyrii et Aristotelis", "year": 1492, "printer": "Paltašić, Andrija", "print_place": "Venecija"}, {"author": "BUNIĆ, JAKOV", "title": "De raptu Cerberi libri tres.", "year": 1490, "printer": "Plannck, Stephan", "print_place": "Rim"}, {"author": "BLONDUS, FLAVIUS", "title": "Roma instaurata.", "year": 1481, "printer": "Dobrićević, Dobrić", "print_place": "Verona"}, {"author": "BLONDUS, FLAVIUS", "title": "Roma instaurata.", "year": 1481, "printer": "Dobrićević, Dobrić", "print_place": "Verona"}, {"author": "", "title": "BIBLIA", "year": 1484, "printer": "Paltašić, Andrija", "print_place": "Venecija"}, {"author": "BALDUS DE UBALDIS", "title": "Consiliorum partes V.", "year": 1490, "printer": "Dobrićević, Dobrić", "print_place": "Brescia"}, {"author": "ANTONINUS FLORENTINUS", "title": "Summa theologica. Pars III.", "year": 1485, "printer": "Paltašić, Andrija", "print_place": "Venecija"}, {"author": "ALIGHIERI, DANTE", "title": "La Commedia", "year": 1487, "printer": "Dobrićević, Dobrić", "print_place": "Brescia"}, {"author": "ALBUMASAR", "title": "Introductorium in astronomiam", "year": 1489, "printer": "Ratdolt, Erhard", "print_place": "Augsburg"}, {"author": "ALBERTUS MAGNUS, SANCTUS", "title": "Compendium theologicae veritatis", "year": 1483, "printer": "Grgur Senjanin Jacobum Britannicum", "print_place": "Venecija"}, {"author": "ALBERTUS MAGNUS, SANCTUS", "title": "Compendium theologicae veritatis", "year": 1483, "printer": "Grgur Senjanin Jacobum Britannicum", "print_place": "Venecija"}, {"author": "ALBERTUS DE SAXONIA", "title": "De proportionibus.", "year": 1487, "printer": "Paltašić, Andrija", "print_place": "Venecija"}, {"author": "", "title": "Misal po zakonu rimskoga dvora", "year": 1483, "printer": "", "print_place": ""}, {"author": "", "title": "Misal po zakonu rimskoga dvora", "year": 1483, "printer": "", "print_place": ""}, {"author": "", "title": "Breviarium romanum", "year": 1493, "printer": "Torresanus, Andreas, de Asula Baromić, Blaž", "print_place": "Venecija"}, {"author": "", "title": "Breviarium romanum", "year": 1493, "printer": "Torresanus, Andreas, de Asula Baromić, Blaž", "print_place": "Venecija"}]}, {"name": "Samostan sv. Franje Ksaverskoga", "label": "Samostan sv. Franje Ksaverskoga, Zagreb", "count": 2, "exemplars": [{"author": "", "title": "Misal po zakonu rimskoga dvora", "year": 1483, "printer": "", "print_place": ""}, {"author": "Carcano, Michele", "title": "Spovid općena", "year": 1496, "printer": "Baromić, Blaž", "print_place": "Senj"}]}, {"name": "Staroslavenski institut", "label": "Staroslavenski institut, Zagreb", "count": 1, "exemplars": [{"author": "", "title": "Misal po zakonu rimskoga dvora", "year": 1483, "printer": "", "print_place": ""}]}]}, {"place": "Šibenik", "lat": 43.735, "lon": 15.8896, "total": 7, "institutions": [{"name": "Franjevački samostan sv. Frane", "label": "Franjevački samostan sv. Frane, Šibenik", "count": 5, "exemplars": [{"author": "ODONIS, GERALDUS", "title": "Expositio in Aristotelis Ethica", "year": 1482, "printer": "Dobrićević, Dobrić Manerva, Bonifacius de", "print_place": "Brescia"}, {"author": "HIERONYMUS, SANCTUS", "title": "Vita et transitus", "year": 1480, "printer": "Manzolus, Michael", "print_place": "Treviso"}, {"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1497, "printer": "Rubeis, Laurentius de, de Valentia", "print_place": "Ferrara"}, {"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1496, "printer": "Pincius, Doninus", "print_place": "Venecija"}, {"author": "HIERONYMUS, SANCTUS", "title": "Commentaria in Bibliam", "year": 1497, "printer": "Gregoriis, Johannes de", "print_place": "Venecija"}]}, {"name": "Franjevački samostan sv. Lovre", "label": "Franjevački samostan sv. Lovre, Šibenik", "count": 2, "exemplars": [{"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1496, "printer": "Vercellensis, Johannes Rubeus", "print_place": "Venecija"}, {"author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1470, "printer": "Sweynheym, Konrad Pannartz, Arnold", "print_place": "Rim"}]}]}];
const OPT_PLACES = ["Bol", "Cavtat", "Cres", "Dubrovnik", "Hvar", "Kampor", "Koprivnica", "Korčula", "Košljun", "Kraj", "Našice", "Pula", "Rijeka", "Split", "Trogir", "Varaždin", "Visovac", "Zadar", "Zagreb", "Šibenik"];
const OPT_INST   = ["Arheološki muzej, Split", "Bogoslovno sjemenište, Split", "Dominikanski samostan Sv. Marije Milosne, Bol", "Dominikanski samostan sv. Katarine, Split", "Državni arhiv Dubrovnik, Dubrovnik", "Državni arhiv u Zadru, Zadar", "Franjevački samostan Gospe od anđela, Visovac", "Franjevački samostan Gospe od milosti, Hvar", "Franjevački samostan Majke Božje Trsatske, Rijeka", "Franjevački samostan Male braće, Dubrovnik", "Franjevački samostan Navještenja Marijina, Košljun", "Franjevački samostan sv. Antuna Padovanskog, Koprivnica", "Franjevački samostan sv. Antuna Padovanskog, Našice", "Franjevački samostan sv. Bernardina Sijenskog, Kampor", "Franjevački samostan sv. Duje, Kraj", "Franjevački samostan sv. Frane, Zadar", "Franjevački samostan sv. Frane, Šibenik", "Franjevački samostan sv. Franje Asiškog, Zagreb", "Franjevački samostan sv. Franje, Cres", "Franjevački samostan sv. Ivana Krstitelja, Varaždin", "Franjevački samostan sv. Lovre, Šibenik", "Franjevački samostan svetog Ante, Split", "Katolički bogoslovni fakultet, Split", "Knjižnica 'Juraj Habdelić', Zagreb", "Knjižnica Hrvatske akademije znanosti i umjetnosti, Zagreb", "Knjižnica Hvarske biskupije, Hvar", "Knjižnice Grada Zagreba, Zagreb", "Metropolitanska knjižnica, Zagreb", "Muzej grada Trogira, Trogir", "Muzej suvremene umjetnosti, Zagreb", "Nacionalna i sveučilišna knjižnica u Zagrebu, Zagreb", "Nadbiskupski ordinarijat, Zadar", "Opatska knjižnica, Korčula", "Prva gimnazija Split, Split", "Samostan sv. Franje Ksaverskoga, Zagreb", "Staroslavenski institut, Zagreb", "Sveučilišna knjižnica u Puli, Pula", "Zbirka Baltazara Bogišića, Cavtat", "Znanstvena knjižnica Sveučilišta u Zadru, Zadar", "Znanstvena knjižnica, Dubrovnik"];
const OPT_PRN    = ["Adamus, Rotwilensis", "Baromić, Blaž", "Bedričić, Silvestar Turčić, Gašpar Baromić, Blaž", "Benalius, Bernardinus", "Benedictis, Franciscus (Plato) de", "Bevilacqua, Simone", "Bonaccorsi, Francesco", "Braem, Konrad", "Capcasa, Matteo", "Damianus de Gorgonzola", "Darleri, Carlo", "Dobrićević, Dobrić", "Dobrićević, Dobrić Delsera, Miniatus", "Dobrićević, Dobrić Manerva, Bonifacius de", "Gallo, Guglielmo", "Gensberg, Johannes", "Girardengus, Nicolaus, de Novis", "Gregoriis, Johannes de", "Grgur Senjanin Jacobum Britannicum", "Guldinbeck, Bartholomaeus", "Hannibal Foxius", "Kessler, Nicolaus", "Libris, Bartholomeo de", "Lichtenstein, Hermann", "Manzolus, Michael", "Miscomini, Antonio di Bartolommeo", "Nepoznat", "Paganini, Paganino de’, st.", "Paltašić, Andrija", "Paltašić, Andrija Dobrićević, Dobrić", "Paltašić, Andrija Scotus, Octavianus", "Pasqualibus, Peregrinus de Bertochus, Dominicus", "Pelusius, Bartholomaeus Bracius, Gabriel Bissolus, Johannes Mangius, Benedictus", "Pietro, Gabriele di", "Pincius, Doninus", "Plannck, Stephan", "Ratdolt, Erhard", "Ratdolt, Erhard Löslein, Peter", "Rubeis, Laurentius de, de Valentia", "Scotus, Octavianus", "Silber, Eucharius", "Siliprandi, Domenico", "Sweynheym, Konrad Pannartz, Arnold", "Tacuinus, Giovanni", "Torresanus, Andreas, de Asula Baromić, Blaž", "Typ. Hieronymi", "Vercellensis, Johannes Rubeus", "Wagner, Petrus"];
const YEAR_MIN   = 1470;
const YEAR_MAX   = 1501;

const map = L.map('map',{maxZoom:8}).setView([45.1,15.2],6);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{attribution:'&copy; OpenStreetMap contributors'}).addTo(map);
const cluster=L.markerClusterGroup({disableClusteringAtZoom:9}); map.addLayer(cluster);

const panel=document.getElementById('panel');
document.getElementById('togglePanel').onclick=()=>panel.classList.toggle('open');
document.getElementById('closePanel').onclick =()=>panel.classList.remove('open');

function esc(s){return String(s??'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');}
function size(n){return Math.max(10,Math.sqrt(n)*3.5);}
function getMulti(sel){return Array.from(sel.options).filter(o=>o.selected&&o.value!=='').map(o=>o.value);}
function fill(id,list){list.forEach(v=>{const o=document.createElement('option');o.value=v;o.textContent=v;document.getElementById(id).appendChild(o);});}

function aggregateFiltered(placeItem, instSel, prnSel, yMin, yMax){
  const institutions=[]; let total=0;
  placeItem.institutions.forEach(inst=>{
    const label = `${inst.name}, ${placeItem.place}`.trim();
    if(instSel.length && !instSel.includes(label)) return;
    const ex=inst.exemplars.filter(e=>{
      if(prnSel.length&&!prnSel.includes((e.printer||'').trim()))return false;
      if(e.year!==null&&(e.year<yMin||e.year>yMax))return false;
      return true;
    });
    if(!ex.length)return;
    total+=ex.length;
    institutions.push({name:inst.name,label:label,count:ex.length,exemplars:ex});
  });
  return {institutions,total};
}

function buildInstRow(inst){
  const rows=inst.exemplars.map(e=>{
    return `<tr>
      <td>${esc(e.author)}</td>
      <td>${esc(e.title)}</td>
      <td class='num'>${e.year??''}</td>
      <td>${esc(e.printer)}</td>
      <td>${esc(e.print_place)}</td>
    </tr>`;
  }).join('');
  const table=`<table class="table-mini">
    <thead><tr><th>Autor</th><th>Naslov</th><th class='num'>God.</th><th>Tiskar</th><th>Mjesto tiskanja</th></tr></thead>
    <tbody>${rows}</tbody></table>`;
  const uid=Math.random().toString(36).slice(2);
  return `<div class="acc-item" id="acc-${uid}">
    <div class="acc-head" onclick="const b=document.querySelector('#acc-${uid} .acc-body'); b.style.display=(b.style.display==='block'?'none':'block')">
      <span>${esc(inst.name)}</span> <span class="count">(${inst.count})</span>
    </div>
    <div class="acc-body">${table}</div>
  </div>`;
}

function popupHTML(place, dataAgg){
  const list=dataAgg.institutions.map(buildInstRow).join('')||"<em>Nema zapisa po filtrima.</em>";
  return `<div style="font-weight:700;margin-bottom:6px;">${esc(place)}</div>${list}`;
}

function buildMarkers(items){
  cluster.clearLayers();
  const popup=L.popup({maxWidth:760,autoPan:false});
  items.forEach(it=>{
    const m=L.circleMarker([it.lat,it.lon],{radius:size(it.total),color:'#0d47a1',weight:1,fillColor:'#1e3a8a',fillOpacity:0.70})
      .bindTooltip(`${esc(it.place)} — ${it.total}`,{sticky:true});
    cluster.addLayer(m);
    m.on('click',()=>{
      const instSel=getMulti(document.getElementById('instSel'));
      const prnSel =getMulti(document.getElementById('prnSel'));
      const yMin=parseInt(document.getElementById('yMin').value)||YEAR_MIN;
      const yMax=parseInt(document.getElementById('yMax').value)||YEAR_MAX;
      const agg=aggregateFiltered(it,instSel,prnSel,yMin,yMax);
      popup.setLatLng([it.lat,it.lon]).setContent(popupHTML(it.place,agg)); popup.openOn(map);
    });
  });
  if(items.length){
    const b=L.latLngBounds(items.map(i=>[i.lat,i.lon])); map.fitBounds(b,{maxZoom:8});
  }
}

function applyFilters(){
  const placeSel=getMulti(document.getElementById('placeSel'));
  const instSel =getMulti(document.getElementById('instSel')); // "Ustanova, Mjesto"
  const prnSel  =getMulti(document.getElementById('prnSel'));
  const yMin=parseInt(document.getElementById('yMin').value)||YEAR_MIN;
  const yMax=parseInt(document.getElementById('yMax').value)||YEAR_MAX;

  const filtered=RAW.map(it=>{
    if(placeSel.length&&!placeSel.includes((it.place||'').trim()))return null;
    const agg=aggregateFiltered(it,instSel,prnSel,yMin,yMax);
    if(agg.total===0)return null;
    return {...it,total:agg.total,institutions:agg.institutions};
  }).filter(Boolean);

  buildMarkers(filtered);
  panel.classList.remove('open');
}

function resetFilters(){
  document.querySelectorAll('#placeSel option,#instSel option,#prnSel option').forEach(o=>o.selected=false);
  document.getElementById('yMin').value=YEAR_MIN;
  document.getElementById('yMax').value=YEAR_MAX;
  buildMarkers(RAW);
}

/* === Init === */
fill('placeSel',OPT_PLACES);
fill('instSel',OPT_INST);
fill('prnSel',OPT_PRN);

document.getElementById('applyBtn').onclick=applyFilters;
document.getElementById('resetBtn').onclick=resetFilters;

resetFilters();
</script>
</body>
</html>
