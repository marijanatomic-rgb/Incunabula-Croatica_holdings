<!DOCTYPE html>
<html lang="hr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Inkunabule — karta s filterima</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />
<style>
  html, body, #map { height: 100%; margin: 0; }
  .panel {
    position: absolute; top: 10px; left: 10px; z-index: 1000;
    background: rgba(255,255,255,0.95); padding: 10px; border-radius: 10px; border: 1px solid #ddd;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; font-size: 14px; max-width: 420px;
  }
  .panel h3 { margin: 0 0 8px 0; font-size: 16px; }
  .panel label { display:block; margin-top: 6px; font-weight: 600; }
  .panel select, .panel input[type="number"] { width: 100%; padding: 6px; border:1px solid #ccc; border-radius:8px; }
  .hint { font-size: 12px; color:#555; margin-top:2px; }
  .row { display:flex; gap:8px; align-items:center; }
  .row > div { flex:1; }
  .btns { display:flex; gap:8px; margin-top:8px; flex-wrap: wrap; }
  button { padding:6px 10px; border:1px solid #ccc; border-radius: 8px; background:#f6f6f6; cursor:pointer; }
  button:hover { background:#eee; }
  .tab-wrap { font-family: inherit; }
  .tab-input { position:absolute; opacity:0; }
  .tab-label {
    display:inline-block; padding:6px 10px; margin-right:6px;
    border:1px solid #888; border-bottom:none; border-radius:6px 6px 0 0;
    background:#f0f0f0; cursor:pointer; font-size:13px;
  }
  .tab-panel {
    border:1px solid #888; padding:6px; max-height:240px; overflow:auto;
    background:#fff; border-radius:0 6px 6px 6px;
  }
  .tab-input:checked + .tab-label { background:#fff; font-weight:bold; }
  .tab-input:checked + .tab-label + .tab-panel { display:block; }
  .tab-panel { display:none; }
  .table-mini { width:100%; border-collapse:collapse; font-size:13px; }
  .table-mini th, .table-mini td { padding:4px; border-bottom:1px solid #eee; }
  .table-mini th { text-align:left; }
  .table-mini td.num { text-align:right; }
  .headerline { margin:2px 0 6px 0; font-size:12px; color:#444; }
</style>
</head>
<body>
<div id="map"></div>

<div class="panel">
  <h3>Filtri</h3>

  <label>Mjesto tiskanja (odabir — višestruko)</label>
  <select id="placeSelect" multiple size="6">
    <option value="">(sva mjesta)</option>
  </select>
  <div class="hint">Savjet: držite Ctrl/Cmd za višestruki odabir.</div>

  <label>Tiskar (odabir — višestruko)</label>
  <select id="printerSelect" multiple size="6">
    <option value="">(svi tiskari)</option>
  </select>

  <div class="row">
    <div><label>Godina od</label><input type="number" id="yearMin" min="1200" max="1900" step="1"></div>
    <div><label>Godina do</label><input type="number" id="yearMax" min="1200" max="1900" step="1"></div>
  </div>

  <label style="margin-top:6px;">
    <input type="checkbox" id="popupAll" /> U popupu ignoriraj filtere (prikaži sve podatke za mjesto)
  </label>

  <div class="btns">
    <button id="applyBtn">Primijeni</button>
    <button id="resetBtn">Poništi</button>
    <button id="dlTitlesBtn">Preuzmi CSV — Naslovi (primjerci)</button>
    <button id="dlInstBtn">Preuzmi CSV — Ustanove (agregat)</button>
  </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
<script>
  const RAW = [{"place": "Augsburg", "lat": 48.3705, "lon": 10.8978, "total": 1, "exemplars": [{"printer": "Ratdolt, Erhard", "author": "ALBUMASAR", "title": "Introductorium in astronomiam", "year": 1489, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}]}, {"place": "Basel", "lat": 47.5596, "lon": 7.5886, "total": 6, "exemplars": [{"printer": "Kessler, Nicolaus", "author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1497, "storage_place": "Split", "institution": "Arheološki muzej"}, {"printer": "Kessler, Nicolaus", "author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1497, "storage_place": "Split", "institution": "Katolički bogoslovni fakultet"}, {"printer": "Kessler, Nicolaus", "author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1497, "storage_place": "Zagreb", "institution": "Knjižnica Hrvatske akademije znanosti i umjetnosti"}, {"printer": "Kessler, Nicolaus", "author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1489, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Kessler, Nicolaus", "author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1489, "storage_place": "Košljun", "institution": "Franjevački samostan Navještenja Marijina"}, {"printer": "Kessler, Nicolaus", "author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1489, "storage_place": "Split", "institution": "Arheološki muzej"}]}, {"place": "Bologna", "lat": 44.4938203, "lon": 11.3426327, "total": 1, "exemplars": [{"printer": "Benedictis, Franciscus (Plato) de", "author": "SUETONIUS TRANQUILLUS, GAIUS", "title": "Vitae XII caesarum", "year": 1488, "storage_place": "Dubrovnik", "institution": "Franjevački samostan Male braće"}]}, {"place": "Brescia", "lat": 45.5416, "lon": 10.2118, "total": 32, "exemplars": [{"printer": "Dobrićević, Dobrić Delsera, Miniatus", "author": "VARRO, MARCUS TERENTIUS", "title": "De lingua Latina lib. III.", "year": 1483, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Dobrićević, Dobrić Delsera, Miniatus", "author": "VARRO, MARCUS TERENTIUS", "title": "De lingua Latina lib. III.", "year": 1483, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Dobrićević, Dobrić", "author": "TIBULLUS, ALBIUS", "title": "Elegiae sive carmina", "year": 1486, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Dobrićević, Dobrić", "author": "", "title": "Statuta Cremonae", "year": 1485, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Dobrićević, Dobrić", "author": "PROPERTIUS, SEXTUS AURELIUS", "title": "Elegiae", "year": 1486, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Dobrićević, Dobrić", "author": "PROBUS, MARCUS VALERIUS", "title": "De interpretandis Romanorum litteris.", "year": 1486, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Dobrićević, Dobrić", "author": "PLUTARCHUS", "title": "Parallela minora", "year": 1485, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Dobrićević, Dobrić", "author": "PLUTARCHUS", "title": "De claris mulieribus. De virtutibus mulierum.", "year": 1485, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Dobrićević, Dobrić Manerva, Bonifacius de", "author": "ODONIS, GERALDUS", "title": "Expositio in Aristotelis Ethica", "year": 1482, "storage_place": "Dubrovnik", "institution": "Franjevački samostan Male braće"}, {"printer": "Dobrićević, Dobrić Manerva, Bonifacius de", "author": "ODONIS, GERALDUS", "title": "Expositio in Aristotelis Ethica", "year": 1482, "storage_place": "Šibenik", "institution": "Franjevački samostan sv. Frane"}, {"printer": "Dobrićević, Dobrić", "author": "NONIUS MARCELLUS", "title": "De proprietate Latini sermonis.", "year": 1483, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Dobrićević, Dobrić", "author": "MACROBIUS, AURELIUS THEODOSIUS", "title": "In somnium Scipionis expositio. Saturnalia.", "year": 1485, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Dobrićević, Dobrić", "author": "MACROBIUS, AURELIUS THEODOSIUS", "title": "In somnium Scipionis expositio. Saturnalia.", "year": 1485, "storage_place": "Korèula", "institution": "Opatska knjižnica"}, {"printer": "Dobrićević, Dobrić", "author": "MACROBIUS, AURELIUS THEODOSIUS", "title": "In somnium Scipionis expositio. Saturnalia.", "year": 1485, "storage_place": "Zagreb", "institution": "Metropolitanska knjižnica"}, {"printer": "Dobrićević, Dobrić", "author": "MACROBIUS, AURELIUS THEODOSIUS", "title": "In somnium Scipionis expositio. Saturnalia.", "year": 1485, "storage_place": "Zagreb", "institution": "Metropolitanska knjižnica"}, {"printer": "Dobrićević, Dobrić", "author": "LUDOVICUS A TURRI DE VERONA", "title": "De immaculata conceptione B.V. Mariae", "year": 1486, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Dobrićević, Dobrić", "author": "LUDOVICUS A TURRI DE VERONA", "title": "De immaculata conceptione B.V. Mariae", "year": 1486, "storage_place": "Hvar", "institution": "Franjevački samostan Gospe od milosti"}, {"printer": "Dobrićević, Dobrić", "author": "JACOBUS PHILIPPUS DE BERGAMO", "title": "Supplementum chronicarum", "year": 1485, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Dobrićević, Dobrić", "author": "JACOBUS PHILIPPUS DE BERGAMO", "title": "Supplementum chronicarum", "year": 1485, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Dobrićević, Dobrić", "author": "JACOBUS PHILIPPUS DE BERGAMO", "title": "Supplementum chronicarum", "year": 1485, "storage_place": "Dubrovnik", "institution": "Znanstvena knjižnica"}, {"printer": "Dobrićević, Dobrić", "author": "GELLIUS, AULUS", "title": "Noctes Atticae", "year": 1485, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Dobrićević, Dobrić", "author": "GELLIUS, AULUS", "title": "Noctes Atticae", "year": 1485, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Dobrićević, Dobrić", "author": "GELLIUS, AULUS", "title": "Noctes Atticae", "year": 1485, "storage_place": "Dubrovnik", "institution": "Znanstvena knjižnica"}, {"printer": "Dobrićević, Dobrić", "author": "GELLIUS, AULUS", "title": "Noctes Atticae", "year": 1485, "storage_place": "Korèula", "institution": "Opatska knjižnica"}, {"printer": "Dobrićević, Dobrić", "author": "GELLIUS, AULUS", "title": "Noctes Atticae", "year": 1485, "storage_place": "Zagreb", "institution": "Metropolitanska knjižnica"}, {"printer": "Dobrićević, Dobrić", "author": "FESTUS, SEXTUS POMPEIUS", "title": "De verborum significatione", "year": 1483, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Dobrićević, Dobrić", "author": "CATULLUS, GAIUS VALERIUS", "title": "Carmina", "year": 1486, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Dobrićević, Dobrić", "author": "BALDUS DE UBALDIS", "title": "Consiliorum partes V.", "year": 1490, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Dobrićević, Dobrić", "author": "BALDUS DE UBALDIS", "title": "Consiliorum partes V.", "year": 1490, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Dobrićević, Dobrić", "author": "BALDUS DE UBALDIS", "title": "Consiliorum partes V.", "year": 1490, "storage_place": "Dubrovnik", "institution": "Državni arhiv Dubrovnik"}, {"printer": "Dobrićević, Dobrić", "author": "ALIGHIERI, DANTE", "title": "La Commedia", "year": 1487, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Dobrićević, Dobrić", "author": "AESOPUS", "title": "Aesopus moralisatus", "year": 1487, "storage_place": "Visovac", "institution": "Franjevački samostan Gospe od anđela"}]}, {"place": "Cremona", "lat": 45.2208641, "lon": 10.037038, "total": 1, "exemplars": [{"printer": "Darleri, Carlo", "author": "AEGIDII, GUILLERMUS", "title": "Super coelestium motuum indigatione", "year": 1494, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}]}, {"place": "Ferrara", "lat": 44.8381, "lon": 11.6198, "total": 1, "exemplars": [{"printer": "Rubeis, Laurentius de, de Valentia", "author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1497, "storage_place": "Šibenik", "institution": "Franjevački samostan sv. Frane"}]}, {"place": "Firenza", "lat": 29.4963881, "lon": -95.0507461, "total": 8, "exemplars": [{"printer": "Bonaccorsi, Francesco", "author": "HIERONYMUS, SANCTUS", "title": "Vita et transitus", "year": 1490, "storage_place": "Split", "institution": "Arheološki muzej"}, {"printer": "Nepoznat", "author": "DRAGIŠIÆ, JURAJ", "title": "Oratio funebris pro Junio Georgio habita", "year": 1499, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Nepoznat", "author": "DRAGIŠIÆ, JURAJ", "title": "Oratio funebris pro Junio Georgio habita", "year": 1499, "storage_place": "Dubrovnik", "institution": "Franjevački samostan Male braće"}, {"printer": "Libris, Bartholomeo de", "author": "DRAGIŠIÆ, JURAJ", "title": "De natura angelica.", "year": 1499, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Libris, Bartholomeo de", "author": "DRAGIŠIÆ, JURAJ", "title": "De natura angelica.", "year": 1499, "storage_place": "Dubrovnik", "institution": "Franjevački samostan Male braće"}, {"printer": "Libris, Bartholomeo de", "author": "DRAGIŠIÆ, JURAJ", "title": "De natura angelica.", "year": 1499, "storage_place": "Dubrovnik", "institution": "Znanstvena knjižnica"}, {"printer": "Libris, Bartholomeo de", "author": "DRAGIŠIÆ, JURAJ", "title": "De natura angelica.", "year": 1499, "storage_place": "Zagreb", "institution": "Knjižnica Hrvatske akademije znanosti i umjetnosti"}, {"printer": "Libris, Bartholomeo de", "author": "DRAGIŠIÆ, JURAJ", "title": "De natura angelica.", "year": 1499, "storage_place": "Zagreb", "institution": "Knjižnica 'Juraj Habdelić'"}]}, {"place": "Lyon", "lat": 45.764, "lon": 4.8357, "total": 1, "exemplars": [{"printer": "Dobrićević, Dobrić", "author": "", "title": "OFFICIUM", "year": 1501, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}]}, {"place": "Löwen", "lat": 50.879202, "lon": 4.7011675, "total": 1, "exemplars": [{"printer": "Braem, Konrad", "author": "DIONYSIUS CARTHUSIANUS", "title": "Dialogus Mariae et peccatoris etc.", "year": 1480, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}]}, {"place": "Nürnberg", "lat": 49.4521, "lon": 11.0767, "total": 1, "exemplars": [{"printer": "Wagner, Petrus", "author": "FIDELIS, CASSANDRA", "title": "Oratio pro Bertucio Lamberto etc.", "year": 1489, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}]}, {"place": "Padova", "lat": 45.4064, "lon": 11.8768, "total": 1, "exemplars": [{"printer": "Siliprandi, Domenico", "author": "VERGERIUS, PETRUS PAULUS", "title": "De ingenuis moribus ac liberalibus studiis", "year": 1475, "storage_place": "Pula", "institution": "Sveučilišna knjižnica u Puli"}]}, {"place": "Parma", "lat": 44.6952006, "lon": 10.0979869, "total": 4, "exemplars": [{"printer": "Typ. Hieronymi", "author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1480, "storage_place": "Dubrovnik", "institution": "Franjevački samostan Male braće"}, {"printer": "Typ. Hieronymi", "author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1480, "storage_place": "Split", "institution": "Dominikanski samostan sv. Katarine"}, {"printer": "Typ. Hieronymi", "author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1480, "storage_place": "Split", "institution": "Franjevački samostan svetog Ante"}, {"printer": "Typ. Hieronymi", "author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1480, "storage_place": "Zadar", "institution": "Franjevački samostan sv. Frane"}]}, {"place": "Rim", "lat": 41.9028, "lon": 12.4964, "total": 8, "exemplars": [{"printer": "Silber, Eucharius", "author": "NIMIRA, MARTINUS DE", "title": "Sermo de passione Domini.", "year": 1494, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Guldinbeck, Bartholomaeus", "author": "NIKOLA MODRUŠKI", "title": "Oratio in funere Reverendissimi domini D. Petri Cardinalis sancti Sixti habita a revere[n]do patre d[omi]no Nicolao ep[isco]po Modrusien[si]", "year": 1484, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Plannck, Stephan", "author": "NIKOLA MODRUŠKI", "title": "Oratio in funere Petri cardinalis s. Sixti habita.", "year": 1481, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Gensberg, Johannes", "author": "NIKOLA MODRUŠKI", "title": "Oratio in funere Petri cardinalis s. Sixti habita.", "year": 1474, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Sweynheym, Konrad Pannartz, Arnold", "author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1470, "storage_place": "Šibenik", "institution": "Franjevački samostan sv. Lovre"}, {"printer": "Sweynheym, Konrad Pannartz, Arnold", "author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1470, "storage_place": "Zagreb", "institution": "Franjevački samostan sv. Franje Asiškog"}, {"printer": "Plannck, Stephan", "author": "BUNIÆ, JAKOV", "title": "De raptu Cerberi libri tres.", "year": 1490, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Silber, Eucharius", "author": "ARISTOTELES", "title": "Politica", "year": 1492, "storage_place": "Split", "institution": "Prva gimnazija Split"}]}, {"place": "Senj", "lat": 44.9901533, "lon": 14.9021159, "total": 2, "exemplars": [{"printer": "Bedrièić, Silvestar Turèić, Gašpar Baromić, Blaž", "author": "", "title": "Senjski glagoljski misal", "year": 1494, "storage_place": "Cres", "institution": "Franjevački samostan sv. Franje"}, {"printer": "Baromić, Blaž", "author": "Carcano, Michele", "title": "Spovid općena", "year": 1496, "storage_place": "Zagreb", "institution": "Samostan sv. Franje ksaverskoga"}]}, {"place": "Treviso", "lat": 45.8066913, "lon": 12.2063158, "total": 1, "exemplars": [{"printer": "Manzolus, Michael", "author": "HIERONYMUS, SANCTUS", "title": "Vita et transitus", "year": 1480, "storage_place": "Šibenik", "institution": "Franjevački samostan sv. Frane"}]}, {"place": "Venecija", "lat": 45.4408, "lon": 12.3155, "total": 94, "exemplars": [{"printer": "Paltašić, Andrija", "author": "VERGILIUS MARO, PUBLIUS", "title": "Opera", "year": 1488, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Tacuinus, Giovanni", "author": "VERGERIUS, PETRUS PAULUS", "title": "De ingenuis moribus ac liberalibus studiis", "year": 1497, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Paltašić, Andrija", "author": "TORTELLIUS, JOHANNES", "title": "De orthographia dictionum e Graecis tractarum.", "year": 1488, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Paltašić, Andrija", "author": "TIBULLUS, ALBIUS", "title": "Elegiae", "year": 1487, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Paltašić, Andrija", "author": "", "title": "Elegiae", "year": 1487, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Paltašić, Andrija", "author": "TERENTIUS AFER, PUBLIUS", "title": "Comoediae", "year": 1487, "storage_place": "Zagreb", "institution": "Knjižnica Hrvatske akademije znanosti i umjetnosti"}, {"printer": "Adamus, Rotwilensis", "author": "ŠIŽGORIÆ, JURAJ", "title": "Elegiarum et carminum libri tres.", "year": 1477, "storage_place": "Zagreb", "institution": "Knjižnica Hrvatske akademije znanosti i umjetnosti"}, {"printer": "Gallo, Guglielmo", "author": "ŠIMUN HVARANIN", "title": "De baptismo Sancti Spiritus et eius virtute", "year": 1477, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Gallo, Guglielmo", "author": "ŠIMUN HVARANIN", "title": "De baptismo Sancti Spiritus et eius virtute", "year": 1477, "storage_place": "Košljun", "institution": "Franjevački samostan Navještenja Marijina"}, {"printer": "Damianus de Gorgonzola", "author": "PUCIÆ, KARLO", "title": "Elegiarum libellus De laudibus Gnesae puellae", "year": 1495, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Damianus de Gorgonzola", "author": "PUCIÆ, KARLO", "title": "Elegiarum libellus De laudibus Gnesae puellae", "year": 1495, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Paltašić, Andrija", "author": "PROPERTIUS, SEXTUS AURELIUS", "title": "Elegiae", "year": 1488, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Paltašić, Andrija", "author": "PROPERTIUS, SEXTUS AURELIUS", "title": "Elegiae", "year": 1488, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Pelusius, Bartholomaeus Bracius, Gabriel Bissolus, Johannes Mangius, Benedictus", "author": "PHALARIS", "title": "Epistolae", "year": 1498, "storage_place": "Pula", "institution": "Sveučilišna knjižnica u Puli"}, {"printer": "Bevilacqua, Simone", "author": "NIGER, FRANJO", "title": "Modus epistolandi.", "year": 1495, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Capcasa, Matteo", "author": "NIGER, FRANJO", "title": "Modus epistolandi.", "year": 1492, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Paltašić, Andrija Scotus, Octavianus", "author": "MARCHESINUS, JOHANNES", "title": "Mammotrectus super Bibliam.", "year": 1482, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Paltašić, Andrija Scotus, Octavianus", "author": "MARCHESINUS, JOHANNES", "title": "Mammotrectus super Bibliam.", "year": 1482, "storage_place": "Kampor", "institution": "Franjevački samostan sv. Bernardina Sijenskog"}, {"printer": "Paltašić, Andrija Dobrićević, Dobrić", "author": "LACTANTIUS, LUCIUS CAECILIUS FIRMIANUS", "title": "Opera", "year": 1478, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Paltašić, Andrija Dobrićević, Dobrić", "author": "LACTANTIUS, LUCIUS CAECILIUS FIRMIANUS", "title": "Opera", "year": 1478, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Paltašić, Andrija Dobrićević, Dobrić", "author": "LACTANTIUS, LUCIUS CAECILIUS FIRMIANUS", "title": "Opera", "year": 1478, "storage_place": "Zadar", "institution": "Znanstvena knjižnica Sveučilišta u Zadru"}, {"printer": "Paltašić, Andrija Scotus, Octavianus", "author": "JACOBUS DE VORAGINE", "title": "Legenda aurea sanctorum, sive Lombardica historia", "year": 1482, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Paltašić, Andrija", "author": "IUVENALIS, DECIMUS IUNIUS", "title": "Satyrae", "year": 1488, "storage_place": "Dubrovnik", "institution": "Znanstvena knjižnica"}, {"printer": "Scotus, Octavianus", "author": "HIERONYMUS, SANCTUS", "title": "Vitae sanctorum patrum, sive Vitas patrum", "year": 1483, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Scotus, Octavianus", "author": "HIERONYMUS, SANCTUS", "title": "Vitae sanctorum patrum, sive Vitas patrum", "year": 1483, "storage_place": "Košljun", "institution": "Franjevački samostan Navještenja Marijina"}, {"printer": "Scotus, Octavianus", "author": "HIERONYMUS, SANCTUS", "title": "Vitae sanctorum patrum, sive Vitas patrum", "year": 1483, "storage_place": "Varaždin", "institution": "Franjevački samostan sv. Ivana Krstitelja"}, {"printer": "Scotus, Octavianus", "author": "HIERONYMUS, SANCTUS", "title": "Vitae sanctorum patrum, sive Vitas patrum", "year": 1483, "storage_place": "Zagreb", "institution": "Metropolitanska knjižnica"}, {"printer": "Girardengus, Nicolaus, de Novis", "author": "HIERONYMUS, SANCTUS", "title": "Vitae sanctorum patrum, sive Vitas patrum", "year": 1479, "storage_place": "Zadar", "institution": "Franjevački samostan sv. Frane"}, {"printer": "Miscomini, Antonio di Bartolommeo", "author": "HIERONYMUS, SANCTUS", "title": "Vitae sanctorum patrum, sive Vitas patrum", "year": 1476, "storage_place": "Hvar", "institution": "Franjevački samostan Gospe od milosti"}, {"printer": "Hannibal Foxius", "author": "HIERONYMUS, SANCTUS", "title": "Vita et transitus", "year": 1487, "storage_place": "Zadar", "institution": "Nadbiskupski ordinarijat"}, {"printer": "Pasqualibus, Peregrinus de Bertochus, Dominicus", "author": "HIERONYMUS, SANCTUS", "title": "Vita et transitus", "year": 1485, "storage_place": "Zagreb", "institution": "Metropolitanska knjižnica"}, {"printer": "Pasqualibus, Peregrinus de Bertochus, Dominicus", "author": "HIERONYMUS, SANCTUS", "title": "Vita et transitus", "year": 1485, "storage_place": "Zagreb", "institution": "Metropolitanska knjižnica"}, {"printer": "Pietro, Gabriele di", "author": "HIERONYMUS, SANCTUS", "title": "Vita et transitus", "year": 1475, "storage_place": "Dubrovnik", "institution": "Franjevački samostan Male braće"}, {"printer": "Vercellensis, Johannes Rubeus", "author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1496, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Vercellensis, Johannes Rubeus", "author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1496, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Vercellensis, Johannes Rubeus", "author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1496, "storage_place": "Dubrovnik", "institution": "Franjevački samostan Male braće"}, {"printer": "Vercellensis, Johannes Rubeus", "author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1496, "storage_place": "Hvar", "institution": "Knjižnica Hvarske biskupije"}, {"printer": "Vercellensis, Johannes Rubeus", "author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1496, "storage_place": "Kraj", "institution": "Franjevački samostan sv. Duje"}, {"printer": "Vercellensis, Johannes Rubeus", "author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1496, "storage_place": "Šibenik", "institution": "Franjevački samostan sv. Lovre"}, {"printer": "Vercellensis, Johannes Rubeus", "author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1496, "storage_place": "Zadar", "institution": "Znanstvena knjižnica Sveučilišta u Zadru"}, {"printer": "Pincius, Doninus", "author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1496, "storage_place": "Šibenik", "institution": "Franjevački samostan sv. Frane"}, {"printer": "Benalius, Bernardinus", "author": "HIERONYMUS, SANCTUS", "title": "Epistole", "year": 1490, "storage_place": "Zadar", "institution": "Franjevački samostan sv. Frane"}, {"printer": "Miscomini, Antonio di Bartolommeo", "author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1476, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Miscomini, Antonio di Bartolommeo", "author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1476, "storage_place": "Kampor", "institution": "Franjevački samostan sv. Bernardina Sijenskog"}, {"printer": "Miscomini, Antonio di Bartolommeo", "author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1476, "storage_place": "Split", "institution": "Bogoslovno sjemenište"}, {"printer": "Miscomini, Antonio di Bartolommeo", "author": "HIERONYMUS, SANCTUS", "title": "Epistolae", "year": 1476, "storage_place": "Zagreb", "institution": "Knjižnica 'Juraj Habdelić'"}, {"printer": "Gregoriis, Johannes de", "author": "HIERONYMUS, SANCTUS", "title": "Commentaria in Bibliam", "year": 1497, "storage_place": "Hvar", "institution": "Knjižnica Hvarske biskupije"}, {"printer": "Gregoriis, Johannes de", "author": "HIERONYMUS, SANCTUS", "title": "Commentaria in Bibliam", "year": 1497, "storage_place": "Koprivnica", "institution": "Franjevački samostan sv. Antuna Padovanskog"}, {"printer": "Gregoriis, Johannes de", "author": "HIERONYMUS, SANCTUS", "title": "Commentaria in Bibliam", "year": 1497, "storage_place": "Našice", "institution": "Franjevački samostan sv. Antuna Padovanskog"}, {"printer": "Gregoriis, Johannes de", "author": "HIERONYMUS, SANCTUS", "title": "Commentaria in Bibliam", "year": 1497, "storage_place": "Split", "institution": "Dominikanski samostan sv. Katarine"}, {"printer": "Gregoriis, Johannes de", "author": "HIERONYMUS, SANCTUS", "title": "Commentaria in Bibliam", "year": 1497, "storage_place": "Šibenik", "institution": "Franjevački samostan sv. Frane"}, {"printer": "Gregoriis, Johannes de", "author": "HIERONYMUS, SANCTUS", "title": "Commentaria in Bibliam", "year": 1497, "storage_place": "Zagreb", "institution": "Knjižnica 'Juraj Habdelić'"}, {"printer": "Gregoriis, Johannes de", "author": "HIERONYMUS, SANCTUS", "title": "Commentaria in Bibliam", "year": 1497, "storage_place": "Zagreb", "institution": "Muzej suvremene umjetnosti"}, {"printer": "Paltašić, Andrija", "author": "GELLIUS, AULUS", "title": "Noctes Atticae", "year": 1477, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Paltašić, Andrija", "author": "GELLIUS, AULUS", "title": "Noctes Atticae", "year": 1477, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Paltašić, Andrija", "author": "GELLIUS, AULUS", "title": "Noctes Atticae", "year": 1477, "storage_place": "Zagreb", "institution": "Metropolitanska knjižnica"}, {"printer": "Pelusius, Bartholomaeus Bracius, Gabriel Bissolus, Johannes Mangius, Benedictus", "author": "FICINUS, MARSILIUS", "title": "De triplici vita", "year": 1498, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Damianus de Gorgonzola", "author": "", "title": "EVANGELISTARIUM ILLYRICUM", "year": 1495, "storage_place": "Rijeka", "institution": "Franjevački samostan Majke Božje Trsatske"}, {"printer": "Damianus de Gorgonzola", "author": "", "title": "EVANGELISTARIUM ILLYRICUM", "year": 1495, "storage_place": "Zagreb", "institution": "Knjižnica 'Juraj Habdelić'"}, {"printer": "Paltašić, Andrija", "author": "DIODORUS, SICULUS Tacitus, Gaius Cornelius", "title": "Bibliothecae historicae libri VI.", "year": 1476, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Paltašić, Andrija", "author": "DIODORUS, SICULUS Tacitus, Gaius Cornelius", "title": "Bibliothecae historicae libri VI.", "year": 1476, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Ratdolt, Erhard Löslein, Peter", "author": "CIPIKO, KORIOLAN", "title": "Petri Mocenici imperatoris gesta", "year": 1477, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Ratdolt, Erhard Löslein, Peter", "author": "CIPIKO, KORIOLAN", "title": "Petri Mocenici imperatoris gesta", "year": 1477, "storage_place": "Dubrovnik", "institution": "Franjevački samostan Male braće"}, {"printer": "Ratdolt, Erhard Löslein, Peter", "author": "CIPIKO, KORIOLAN", "title": "Petri Mocenici imperatoris gesta", "year": 1477, "storage_place": "Trogir", "institution": "Muzej grada Trogira"}, {"printer": "Ratdolt, Erhard Löslein, Peter", "author": "CIPIKO, KORIOLAN", "title": "Petri Mocenici imperatoris gesta", "year": 1477, "storage_place": "Zadar", "institution": "Državni arhiv u Zadru"}, {"printer": "Paltašić, Andrija", "author": "CICERO, MARCUS TULLIUS", "title": "Epistolae ad familiares (comm. Hubertinus Clericus Crescentinas)", "year": 1488, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Paltašić, Andrija", "author": "CICERO, MARCUS TULLIUS", "title": "Epistolae ad familiares", "year": 1487, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Paltašić, Andrija", "author": "CICERO, MARCUS TULLIUS", "title": "Epistole ad familiares", "year": 1480, "storage_place": "Dubrovnik", "institution": "Znanstvena knjižnica"}, {"printer": "Paltašić, Andrija", "author": "CICERO, MARCUS TULLIUS", "title": "Epistole ad familiares", "year": 1480, "storage_place": "Hvar", "institution": "Franjevački samostan Gospe od milosti"}, {"printer": "Paltašić, Andrija", "author": "CICERO, MARCUS TULLIUS", "title": "De oratore", "year": 1478, "storage_place": "Dubrovnik", "institution": "Znanstvena knjižnica"}, {"printer": "Paltašić, Andrija", "author": "BURLAEUS, GUALTHERUS", "title": "Expositio in artem veterem Porphyrii et Aristotelis", "year": 1492, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Paltašić, Andrija", "author": "BURLAEUS, GUALTHERUS", "title": "Expositio in artem veterem Porphyrii et Aristotelis", "year": 1492, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Paltašić, Andrija", "author": "", "title": "BIBLIA", "year": 1484, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Paltašić, Andrija", "author": "BARTOLUS DE SAXOFERRATO", "title": "Super secunda parte Digesti veteris cum additionibus Alexandri Tartagni.", "year": 1492, "storage_place": "Zadar", "institution": "Franjevački samostan sv. Frane"}, {"printer": "Paltašić, Andrija", "author": "BARTOLUS DE SAXOFERRATO", "title": "Super secunda parte Digesti veteris cum additionibus Alexandri Tartagni.", "year": 1492, "storage_place": "Zagreb", "institution": "Metropolitanska knjižnica"}, {"printer": "Paltašić, Andrija", "author": "BARTOLUS DE SAXOFERRATO", "title": "Super prima parte Codicis cum additionibus Alexandri Tartagni.", "year": 1491, "storage_place": "Zadar", "institution": "Franjevački samostan sv. Frane"}, {"printer": "Paltašić, Andrija", "author": "BARTOLUS DE SAXOFERRATO", "title": "Super prima parte Codicis cum additionibus Alexandri Tartagni.", "year": 1491, "storage_place": "Zagreb", "institution": "Metropolitanska knjižnica"}, {"printer": "Paltašić, Andrija", "author": "BARTOLUS DE SAXOFERRATO", "title": "Super secunda parte Codicis cum additionibus Alexandri Tartagni.", "year": 1490, "storage_place": "Zadar", "institution": "Franjevački samostan sv. Frane"}, {"printer": "Paltašić, Andrija", "author": "BARTOLUS DE SAXOFERRATO", "title": "Super prima parte Digesti veteris cum additionibus Alexandri Tartagni.", "year": 1490, "storage_place": "Zadar", "institution": "Franjevački samostan sv. Frane"}, {"printer": "Paltašić, Andrija", "author": "AURELIUS, VICTOR SEXTUS", "title": "De viris illustribus", "year": 1477, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Paltašić, Andrija", "author": "AURELIUS, VICTOR SEXTUS", "title": "De viris illustribus", "year": 1477, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Paganini, Paganino de’, st.", "author": "Aristotelis", "title": "Auctoritates", "year": 1495, "storage_place": "Dubrovnik", "institution": "Franjevački samostan Male braće"}, {"printer": "Paganini, Paganino de’, st.", "author": "Aristotelis", "title": "Auctoritates", "year": 1495, "storage_place": "Košljun", "institution": "Franjevački samostan Navještenja Marijina"}, {"printer": "Paltašić, Andrija", "author": "ANTONINUS FLORENTINUS", "title": "Summa theologica. Pars III.", "year": 1485, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Paltašić, Andrija", "author": "ANTONINUS FLORENTINUS", "title": "Summa theologica. Pars III.", "year": 1485, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Paltašić, Andrija", "author": "ANTONINUS FLORENTINUS", "title": "Summa theologica. Pars III.", "year": 1485, "storage_place": "Košljun", "institution": "Franjevački samostan Navještenja Marijina"}, {"printer": "Grgur Senjanin Jacobum Britannicum", "author": "ALBERTUS MAGNUS, SANCTUS", "title": "Compendium theologicae veritatis", "year": 1483, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Grgur Senjanin Jacobum Britannicum", "author": "ALBERTUS MAGNUS, SANCTUS", "title": "Compendium theologicae veritatis", "year": 1483, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Grgur Senjanin Jacobum Britannicum", "author": "ALBERTUS MAGNUS, SANCTUS", "title": "Compendium theologicae veritatis", "year": 1483, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Grgur Senjanin Jacobum Britannicum", "author": "ALBERTUS MAGNUS, SANCTUS", "title": "Compendium theologicae veritatis", "year": 1483, "storage_place": "Dubrovnik", "institution": "Franjevački samostan Male braće"}, {"printer": "Paltašić, Andrija", "author": "ALBERTUS DE SAXONIA", "title": "De proportionibus.", "year": 1487, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Paltašić, Andrija", "author": "ALBERTUS DE SAXONIA", "title": "De proportionibus.", "year": 1487, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Torresanus, Andreas, de Asula Baromić, Blaž", "author": "", "title": "Breviarium romanum", "year": 1493, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Torresanus, Andreas, de Asula Baromić, Blaž", "author": "", "title": "Breviarium romanum", "year": 1493, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}]}, {"place": "Verona", "lat": 45.4384, "lon": 10.9916, "total": 7, "exemplars": [{"printer": "Dobrićević, Dobrić", "author": "VALTURIUS, ROBERTUS", "title": "De re militari", "year": 1483, "storage_place": "Zagreb", "institution": "Metropolitanska knjižnica"}, {"printer": "Dobrićević, Dobrić", "author": "VALTURIUS, ROBERTUS", "title": "De re militari", "year": 1483, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Dobrićević, Dobrić", "author": "BLONDUS, FLAVIUS", "title": "Roma instaurata.", "year": 1481, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Dobrićević, Dobrić", "author": "BLONDUS, FLAVIUS", "title": "Roma instaurata.", "year": 1481, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}, {"printer": "Dobrićević, Dobrić", "author": "BLONDUS, FLAVIUS", "title": "Roma instaurata.", "year": 1481, "storage_place": "Cavtat", "institution": "Zbirka Baltazara Bogišića"}, {"printer": "Dobrićević, Dobrić", "author": "BLONDUS, FLAVIUS", "title": "Roma instaurata.", "year": 1481, "storage_place": "Dubrovnik", "institution": "Znanstvena knjižnica"}, {"printer": "Dobrićević, Dobrić", "author": "BLONDUS, FLAVIUS", "title": "Roma instaurata.", "year": 1481, "storage_place": "Zadar", "institution": "Znanstvena knjižnica Sveučilišta u Zadru"}]}, {"place": "Vicenza", "lat": 45.6348591, "lon": 11.4063543, "total": 1, "exemplars": [{"printer": "Lichtenstein, Hermann", "author": "HIERONYMUS, SANCTUS", "title": "Vitae sanctorum patrum, sive Vitas patrum", "year": 1479, "storage_place": "Zagreb", "institution": "Nacionalna i sveučilišna knjižnica u Zagrebu"}]}];
  const ALL_PRINTERS = ["Adamus, Rotwilensis", "Baromić, Blaž", "Bedrièić, Silvestar Turèić, Gašpar Baromić, Blaž", "Benalius, Bernardinus", "Benedictis, Franciscus (Plato) de", "Bevilacqua, Simone", "Bonaccorsi, Francesco", "Braem, Konrad", "Capcasa, Matteo", "Damianus de Gorgonzola", "Darleri, Carlo", "Dobrićević, Dobrić", "Dobrićević, Dobrić Delsera, Miniatus", "Dobrićević, Dobrić Manerva, Bonifacius de", "Gallo, Guglielmo", "Gensberg, Johannes", "Girardengus, Nicolaus, de Novis", "Gregoriis, Johannes de", "Grgur Senjanin Jacobum Britannicum", "Guldinbeck, Bartholomaeus", "Hannibal Foxius", "Kessler, Nicolaus", "Libris, Bartholomeo de", "Lichtenstein, Hermann", "Manzolus, Michael", "Miscomini, Antonio di Bartolommeo", "Nepoznat", "Paganini, Paganino de’, st.", "Paltašić, Andrija", "Paltašić, Andrija Dobrićević, Dobrić", "Paltašić, Andrija Scotus, Octavianus", "Pasqualibus, Peregrinus de Bertochus, Dominicus", "Pelusius, Bartholomaeus Bracius, Gabriel Bissolus, Johannes Mangius, Benedictus", "Pietro, Gabriele di", "Pincius, Doninus", "Plannck, Stephan", "Ratdolt, Erhard", "Ratdolt, Erhard Löslein, Peter", "Rubeis, Laurentius de, de Valentia", "Scotus, Octavianus", "Silber, Eucharius", "Siliprandi, Domenico", "Sweynheym, Konrad Pannartz, Arnold", "Tacuinus, Giovanni", "Torresanus, Andreas, de Asula Baromić, Blaž", "Typ. Hieronymi", "Vercellensis, Johannes Rubeus", "Wagner, Petrus"];
  const ALL_PLACES = ["Augsburg", "Basel", "Bologna", "Brescia", "Cremona", "Ferrara", "Firenza", "Lyon", "Löwen", "Nürnberg", "Padova", "Parma", "Rim", "Senj", "Treviso", "Venecija", "Verona", "Vicenza"];
  const YEAR_MIN = 1470;
  const YEAR_MAX = 1501;

  // UI init
  const selPrinter = document.getElementById('printerSelect');
  ALL_PRINTERS.forEach(p => { const o=document.createElement('option'); o.value=p; o.textContent=p; selPrinter.appendChild(o); });
  const selPlace = document.getElementById('placeSelect');
  ALL_PLACES.forEach(p => { const o=document.createElement('option'); o.value=p; o.textContent=p; selPlace.appendChild(o); });

  document.getElementById('yearMin').value = YEAR_MIN;
  document.getElementById('yearMax').value = YEAR_MAX;

  // Map
  const map = L.map('map').setView([45.1, 15.2], 5);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { attribution: '&copy; OpenStreetMap' }).addTo(map);
  const cluster = L.markerClusterGroup({ disableClusteringAtZoom: 9 });
  map.addLayer(cluster);

  function esc(s) { return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#039;'); }
  function hcode(s) { let h=0; for (let i=0;i<s.length;i++) h = Math.imul(31,h)+s.charCodeAt(i)|0; return h; }
  function size(total) { return Math.max(6, Math.sqrt(total)*3); }
  function getMultiValues(selectEl) { return Array.from(selectEl.options).filter(o => o.selected && o.value!=="").map(o => o.value); }

  // --- aggregate helpers ---
  function aggregateFromExemplars(ex) {
    const cntPrinters = {}, cntYears = {};
    const titlesMap = new Map(), storageMap = new Map();
    ex.forEach(e => {
      if (e.printer) cntPrinters[e.printer] = (cntPrinters[e.printer]||0)+1;
      if (e.year !== null) cntYears[e.year] = (cntYears[e.year]||0)+1;
      const tk = `${e.author}|${e.title}|${e.year??''}|${e.printer}`;
      if (!titlesMap.has(tk)) titlesMap.set(tk, {author:e.author,title:e.title,year:e.year,printer:e.printer,count:0});
      titlesMap.get(tk).count += 1;
      const sk = `${e.storage_place}|${e.institution}`;
      if (!storageMap.has(sk)) storageMap.set(sk, {place:e.storage_place,institution:e.institution,count:0});
      storageMap.get(sk).count += 1;
    });
    const printers = Object.entries(cntPrinters).map(([name,count])=>({name, count})).sort((a,b)=>b.count-a.count);
    const years = Object.entries(cntYears).map(([y,c])=>({year:parseInt(y), count:c})).sort((a,b)=>a.year-b.year);
    const titles = Array.from(titlesMap.values()).sort((a,b)=>(a.year??0)-(b.year??0)||a.author.localeCompare(b.author)||a.title.localeCompare(b.title));
    const storage = Array.from(storageMap.values()).sort((a,b)=>a.place.localeCompare(b.place)||a.institution.localeCompare(b.institution));
    return { printers, years, titles, storage, total: ex.length };
  }

  // filter one place item by current filters (supports multi-place & multi-printer)
  function filterItem(item, placesSel, printersSel, yMin, yMax) {
    if (placesSel.length && !placesSel.includes(item.place)) return null;
    const ex = item.exemplars.filter(e => {
      if (printersSel.length && !printersSel.includes(e.printer)) return false;
      if (e.year !== null && (e.year < yMin || e.year > yMax)) return false;
      return true;
    });
    if (!ex.length) return null;
    const agg = aggregateFromExemplars(ex);
    return { place:item.place, lat:item.lat, lon:item.lon, exemplars: ex, ...agg };
  }

  function popupData(itemFiltered, useAll=false) {
    if (!useAll) return itemFiltered;
    const raw = RAW.find(r => r.place === itemFiltered.place);
    const agg = aggregateFromExemplars(raw ? raw.exemplars : []);
    return { place:itemFiltered.place, lat:itemFiltered.lat, lon:itemFiltered.lon, ...agg };
  }

  function popupHTML(item) {
    const uid = Math.abs(hcode(item.place)) % 1e9;
    const rowsP = item.printers.map(r=>`<tr><td>${esc(r.name)}</td><td class='num'>${r.count}</td></tr>`).join('') || "<tr><td colspan='2'><em>Nema podataka</em></td></tr>";
    const rowsY = item.years.map(r=>`<tr><td>${r.year}</td><td class='num'>${r.count}</td></tr>`).join('') || "<tr><td colspan='2'><em>Nema podataka</em></td></tr>";
    const rowsT = item.titles.map(r=>`<tr><td>${esc(r.author)}</td><td>${esc(r.title)}</td><td class='num'>${r.year??''}</td><td>${esc(r.printer)}</td></tr>`).join('') || "<tr><td colspan='4'><em>Nema podataka</em></td></tr>";
    const rowsS = item.storage.map(r=>`<tr><td>${esc(r.place)}</td><td>${esc(r.institution)}</td><td class='num'>${r.count}</td></tr>`).join('') || "<tr><td colspan='3'><em>Nema zapisa</em></td></tr>";
    return `
      <div class="tab-wrap">
        <div><b>${esc(item.place)}</b></div>
        <div class="headerline">Ukupno primjeraka: <b>${item.total}</b></div>
        <input class="tab-input" type="radio" id="tabP-${uid}" name="tabs-${uid}" checked>
        <label class="tab-label" for="tabP-${uid}">Tiskari</label>
        <div class="tab-panel">
          <table class="table-mini"><thead><tr><th>Tiskar</th><th class='num'>Broj</th></tr></thead><tbody>${rowsP}</tbody></table>
        </div>
        <input class="tab-input" type="radio" id="tabY-${uid}" name="tabs-${uid}">
        <label class="tab-label" for="tabY-${uid}">Godine</label>
        <div class="tab-panel">
          <table class="table-mini"><thead><tr><th>Godina</th><th class='num'>Broj</th></tr></thead><tbody>${rowsY}</tbody></table>
        </div>
        <input class="tab-input" type="radio" id="tabT-${uid}" name="tabs-${uid}">
        <label class="tab-label" for="tabT-${uid}">Naslovi</label>
        <div class="tab-panel">
          <table class="table-mini"><thead><tr><th>Autor</th><th>Naslov</th><th class='num'>God.</th><th>Tiskar</th></tr></thead><tbody>${rowsT}</tbody></table>
        </div>
        <input class="tab-input" type="radio" id="tabS-${uid}" name="tabs-${uid}">
        <label class="tab-label" for="tabS-${uid}">Ustanove & mjesta čuvanja</label>
        <div class="tab-panel">
          <table class="table-mini"><thead><tr><th>Mjesto čuvanja</th><th>Ustanova</th><th class='num'>Primjeraka</th></tr></thead><tbody>${rowsS}</tbody></table>
        </div>
      </div>`;
  }

  // ---- rendering ----
  function buildMarkers(items) {
    cluster.clearLayers();
    const bounds = [];
    const useAll = document.getElementById('popupAll').checked;
    items.forEach(item => {
      const popupItem = popupData(item, useAll);
      const m = L.circleMarker([item.lat, item.lon], {
        radius: size(item.total), color:'darkblue', weight:1, fillColor:'#1e3a8a', fillOpacity:0.65
      }).bindTooltip(`${item.place} — ukupno ${item.total}`, {sticky:true})
        .bindPopup(popupHTML(popupItem));
      cluster.addLayer(m);
      bounds.push([item.lat, item.lon]);
    });
    if (bounds.length) {
      const b = L.latLngBounds(bounds);
      map.fitBounds(b.pad(0.2));
    }
  }

  function currentFilters() {
    const placesSel = getMultiValues(document.getElementById('placeSelect'));
    const printersSel = getMultiValues(document.getElementById('printerSelect'));
    const yMin = parseInt(document.getElementById('yearMin').value) || YEAR_MIN;
    const yMax = parseInt(document.getElementById('yearMax').value) || YEAR_MAX;
    return { placesSel, printersSel, yMin, yMax };
  }

  function applyFilters() {
    const {placesSel, printersSel, yMin, yMax} = currentFilters();
    const subset = RAW.map(it => filterItem(it, placesSel, printersSel, yMin, yMax)).filter(Boolean);
    buildMarkers(subset);
  }

  function resetFilters() {
    Array.from(document.getElementById('placeSelect').options).forEach(o=>o.selected=false);
    Array.from(document.getElementById('printerSelect').options).forEach(o=>o.selected=false);
    document.getElementById('yearMin').value = YEAR_MIN;
    document.getElementById('yearMax').value = YEAR_MAX;
    document.getElementById('popupAll').checked = false;
    const subset = RAW.map(it => filterItem(it, [], [], YEAR_MIN, YEAR_MAX)).filter(Boolean);
    buildMarkers(subset);
  }

  // ---- CSV download helpers (use CURRENT FILTERS; popupAll se ignorira) ----
  function toCSV(rows, headers) {
    const escCell = v => '"' + String(v ?? '').replace(/"/g,'""') + '"';
    const lines = [];
    lines.push(headers.map(escCell).join(','));
    rows.forEach(r => lines.push(headers.map(h => escCell(r[h])).join(',')));
    return lines.join('\n');
  }

  function download(filename, text) {
    const blob = new Blob([text], {type: 'text/csv;charset=utf-8;'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = filename; a.style.display='none';
    document.body.appendChild(a); a.click();
    setTimeout(() => { URL.revokeObjectURL(url); a.remove(); }, 0);
  }

  function buildFilteredExemplarsFlat() {
    const {placesSel, printersSel, yMin, yMax} = currentFilters();
    const all = [];
    RAW.forEach(item => {
      if (placesSel.length && !placesSel.includes(item.place)) return;
      item.exemplars.forEach(e => {
        if (printersSel.length && !printersSel.includes(e.printer)) return;
        if (e.year !== null && (e.year < yMin || e.year > yMax)) return;
        all.push({
          "Mjesto tiskanja": item.place,
          "Autor": e.author,
          "Naslov": e.title,
          "Godina": e.year ?? "",
          "Tiskar": e.printer,
          "Mjesto čuvanja": e.storage_place,
          "Ustanova": e.institution
        });
      });
    });
    return all;
  }

  document.getElementById('dlTitlesBtn').addEventListener('click', () => {
    const rows = buildFilteredExemplarsFlat();
    if (!rows.length) { alert('Nema zapisa za preuzimanje.'); return; }
    const headers = ["Mjesto tiskanja","Autor","Naslov","Godina","Tiskar","Mjesto čuvanja","Ustanova"];
    download('inkunabule_naslovi_primjerci.csv', toCSV(rows, headers));
  });

  document.getElementById('dlInstBtn').addEventListener('click', () => {
    const rows = buildFilteredExemplarsFlat();
    if (!rows.length) { alert('Nema zapisa za preuzimanje.'); return; }
    const key = r => r["Mjesto čuvanja"] + "||" + r["Ustanova"];
    const map = new Map();
    rows.forEach(r => {
      const k = key(r);
      if (!map.has(k)) map.set(k, {"Mjesto čuvanja": r["Mjesto čuvanja"], "Ustanova": r["Ustanova"], "Primjeraka": 0});
      map.get(k)["Primjeraka"] += 1;
    });
    const agg = Array.from(map.values()).sort((a,b)=> a["Mjesto čuvanja"].localeCompare(b["Mjesto čuvanja"]) || a["Ustanova"].localeCompare(b["Ustanova"]));
    const headers = ["Mjesto čuvanja","Ustanova","Primjeraka"];
    download('inkunabule_ustanove_agregat.csv', toCSV(agg, headers));
  });

  // Events
  document.getElementById('applyBtn').addEventListener('click', applyFilters);
  document.getElementById('resetBtn').addEventListener('click', resetFilters);
  document.getElementById('placeSelect').addEventListener('change', applyFilters);
  document.getElementById('printerSelect').addEventListener('change', applyFilters);
  document.getElementById('yearMin').addEventListener('change', applyFilters);
  document.getElementById('yearMax').addEventListener('change', applyFilters);
  document.getElementById('popupAll').addEventListener('change', applyFilters);

  // Initial
  resetFilters();
</script>
</body>
</html>
